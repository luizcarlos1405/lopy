import{S as e,i as t,s as n,e as o,t as s,k as r,c as a,a as l,g as i,d as c,n as d,b as f,f as p,F as u,K as m,J as h,L as v,j as g,m as $,o as y,x,u as E,v as N,M as w,A as I,N as L,r as b,O as k,w as D,P as T,Q as C,R as P}from"../chunks/vendor-c8af0afa.js";import{f as V,P as j,T as A,g as M,R as _,m as R,a as S,e as X}from"../chunks/constants-51170e85.js";import{l as Y}from"../chunks/longpress-838b2f06.js";import"../chunks/singletons-12a22614.js";function O(e){let t,n,v,g,$,y,x,E,N,w,I,L,b=V(e[3])+"";return{c(){t=o("div"),n=o("div"),v=s(e[1]),g=r(),$=o("div"),y=o("div"),x=s(e[2]),E=r(),N=o("div"),w=s(b),this.h()},l(o){t=a(o,"DIV",{id:!0,class:!0});var s=l(t);n=a(s,"DIV",{class:!0});var r=l(n);v=i(r,e[1]),r.forEach(c),g=d(s),$=a(s,"DIV",{class:!0});var f=l($);y=a(f,"DIV",{class:!0});var p=l(y);x=i(p,e[2]),p.forEach(c),E=d(f),N=a(f,"DIV",{class:!0});var u=l(N);w=i(u,b),u.forEach(c),f.forEach(c),s.forEach(c),this.h()},h(){f(n,"class","text-5xl"),f(y,"class","text-2xl truncate"),f(N,"class","font-mono text-base"),f($,"class","text-dark flex flex-col overflow-hidden"),f(t,"id",e[0]),f(t,"class","bg-primary border-box flex space-x-2 rounded-3xl bg-primary shadow p-2")},m(o,s){p(o,t,s),u(t,n),u(n,v),u(t,g),u(t,$),u($,y),u(y,x),u($,E),u($,N),u(N,w),I||(L=m(t,"click",e[5]),I=!0)},p:h,i:h,o:h,d(e){e&&c(t),I=!1,L()}}}function z(e,t,n){let{envelope:o}=t,{_id:s,emoji:r,name:a,value:l}=o;return e.$$set=e=>{"envelope"in e&&n(4,o=e.envelope)},[s,r,a,l,o,function(t){v.call(this,e,t)}]}class B extends e{constructor(e){super(),t(this,e,z,O,n,{envelope:4})}}const F=["touchmove","mousemove"],W=["touchend","mouseup"],G=e=>{var t,n,o,s,r,a;const l={x:e.clientX||(null==(n=null==(t=e.changedTouches)?void 0:t[0])?void 0:n.clientX)||(null==(o=e.detail)?void 0:o.clientX),y:e.clientY||(null==(r=null==(s=e.changedTouches)?void 0:s[0])?void 0:r.clientY)||(null==(a=e.detail)?void 0:a.clientY)};return l.x&&l.y||console.error("Unable to extract position from the event:",e),l},H=(e,{startEvent:t="mousedown",preventClickWhenReleasing:n=!1,onStart:o,onMove:s,onEnd:r}={})=>{let a=Array.from((null==e?void 0:e.children)||[]),l=null,i=null,c=-1,d=null,f={x:0,y:0};const p=e=>t=>{t.stopPropagation(),t.currentTarget.removeEventListener(t.type,p,e)},u=t=>{l=t.currentTarget,n&&t.currentTarget.addEventListener("click",p(!0),!0);const s=l.getBoundingClientRect(),r=G(t);a=Array.from((null==e?void 0:e.children)||[]),l.isDragging=!0,f.x=s.left-t.detail.clientX,f.y=s.top-t.detail.clientY,c=a.findIndex((e=>e===l)),i=l.cloneNode(!0),i.style["pointer-events"]="none",i.style["touch-action"]="none",i.style["z-index"]=1,i.style.width=`${l.clientWidth}px`,i.style.height=`${l.clientHeight}px`,i.style.position="fixed",i.style.top=0,i.style.left=0,i.style.transform=`translate(${s.left}px, ${s.top}px)`,e.appendChild(i),null==o||o({event:t,position:r,containerNode:e,itemNodeCopy:i,itemNode:l,itemNodes:a})},m=t=>{if(!i)return;const n=G(t),o=n.x+f.x,r=n.y+f.y;a=Array.from((null==e?void 0:e.children)||[]),c=a.findIndex((e=>e===l)),i.style.transform=`translate(${o}px, ${r}px)`;const p=document.elementsFromPoint(n.x,n.y).find((t=>(null==t?void 0:t.parentNode)===e));if(p===d)return;const u=a.findIndex((e=>e===p));d=p,u>=0&&c!==u&&(null==s||s({event:t,position:n,fromIndex:c,toIndex:u,toNode:p,containerNode:e,itemNodeCopy:i,itemNode:l,itemNodes:a}),c=u)},h=t=>{if(!i)return;t.stopPropagation(),t.stopImmediatePropagation();const n=G(t);l.style["pointer-events"]="auto",l.style["touch-action"]="auto",l.isDragging=void 0,i.remove(),i=null,null==r||r({event:t,itemNode:l,position:n,containerNode:e,itemNodeCopy:i,itemNodes:a})},v=e=>{e.addEventListener(t,u),F.forEach((e=>window.addEventListener(e,m))),W.forEach((e=>window.addEventListener(e,h)))},g=e=>{e.removeEventListener(t,u),F.forEach((t=>e.removeEventListener(t,m))),W.forEach((t=>e.removeEventListener(t,h)))};a.forEach(v);return new MutationObserver((e=>{Array.from(e).forEach((e=>{var t;return null==(t=e.addedNodes)?void 0:t.forEach((e=>{a.find((t=>t===e))||(v(e,a.length),a.push(e))}))}))})).observe(e,{childList:!0}),{update:e=>{console.error("Parementer updating is not implemented. The dragging behavior will not change.")},destroy:()=>{a.forEach(g)}}};function J(e,t,n){const o=e.slice();return o[10]=t[n],o}function K(e){let t,n,r,d,u,v,w,I;return u=new T({props:{size:"20"}}),{c(){t=o("img"),r=s("\n    Lopy\n    "),d=o("div"),g(u.$$.fragment),this.h()},l(e){t=a(e,"IMG",{class:!0,src:!0,alt:!0}),r=i(e,"\n    Lopy\n    "),d=a(e,"DIV",{class:!0});var n=l(d);$(u.$$.fragment,n),n.forEach(c),this.h()},h(){f(t,"class","mr-1 h-5 w-5"),C(t.src,n="/_app/assets/logo-transparent-a3926526.svg")||f(t,"src","/_app/assets/logo-transparent-a3926526.svg"),f(t,"alt","Lopy"),f(d,"class","cursor-pointer ml-auto")},m(n,o){p(n,t,o),p(n,r,o),p(n,d,o),y(u,d,null),v=!0,w||(I=m(d,"click",e[6]),w=!0)},p:h,i(e){v||(x(u.$$.fragment,e),v=!0)},o(e){E(u.$$.fragment,e),v=!1},d(e){e&&c(t),e&&c(r),e&&c(d),N(u),w=!1,I()}}}function Q(e,t){let n,s,i,m,h,v;return s=new B({props:{envelope:t[10]}}),s.$on("click",(function(){return t[7](t[10])})),{key:e,first:null,c(){n=o("span"),g(s.$$.fragment),i=r(),this.h()},l(e){n=a(e,"SPAN",{class:!0});var t=l(n);$(s.$$.fragment,t),i=d(t),t.forEach(c),this.h()},h(){f(n,"class","outline-none cursor-unset"),this.first=n},m(e,t){p(e,n,t),y(s,n,null),u(n,i),m=!0,h||(v=L(Y.call(null,n)),h=!0)},p(e,n){t=e;const o={};2&n&&(o.envelope=t[10]),s.$set(o)},i(e){m||(x(s.$$.fragment,e),m=!0)},o(e){E(s.$$.fragment,e),m=!1},d(e){e&&c(n),N(s),h=!1,v()}}}function U(e){let t,n,s,i,u,m,h=[],v=new Map;t=new A({props:{$$slots:{default:[K]},$$scope:{ctx:e}}});let w=e[1];const I=e=>e[10]._id;for(let o=0;o<w.length;o+=1){let t=J(e,w,o),n=I(t);v.set(n,h[o]=Q(n,t))}return{c(){g(t.$$.fragment),n=r(),s=o("div");for(let e=0;e<h.length;e+=1)h[e].c();this.h()},l(e){$(t.$$.fragment,e),n=d(e),s=a(e,"DIV",{class:!0});var o=l(s);for(let t=0;t<h.length;t+=1)h[t].l(o);o.forEach(c),this.h()},h(){f(s,"class","w-full p-4 flex flex-col space-y-3")},m(o,r){y(t,o,r),p(o,n,r),p(o,s,r);for(let e=0;e<h.length;e+=1)h[e].m(s,null);i=!0,u||(m=L(H.call(null,s,{startEvent:"longpress",onStart:e[3],onMove:e[4],onEnd:e[5]})),u=!0)},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o),7&n&&(w=e[1],b(),h=k(h,n,I,1,e,w,v,s,P,Q,null,J),D())},i(e){if(!i){x(t.$$.fragment,e);for(let e=0;e<w.length;e+=1)x(h[e]);i=!0}},o(e){E(t.$$.fragment,e);for(let t=0;t<h.length;t+=1)E(h[t]);i=!1},d(e){N(t,e),e&&c(n),e&&c(s);for(let t=0;t<h.length;t+=1)h[t].d();u=!1,m()}}}function q(e){let t,n;return t=new j({props:{$$slots:{default:[U]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,o){y(t,e,o),n=!0},p(e,[n]){const o={};8195&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(x(t.$$.fragment,e),n=!0)},o(e){E(t.$$.fragment,e),n=!1},d(e){N(t,e)}}}function Z(e,t,n){let o,s;w(e,S,(e=>n(9,o=e))),w(e,X,(e=>n(1,s=e)));let r=!1;const a=e=>{M(`${_.ENVELOPE}/${e._id}`)};I((()=>{document.getElementsByTagName("main")[0]}));return[r,s,a,({itemNodeCopy:e,itemNode:t})=>{console.log("itemNodeCopy",e),e.style["box-shadow"]="0px 4px 6px -2px rgba(0,0,0,0.8)",e.style.transform=`${e.style.transform} scale(1.01, 1.01)`,t.style.opacity="10%"},({itemNodeCopy:e,fromIndex:t,toIndex:a})=>{n(0,r=!0);const l=R(s,t,a);e.style.transform=`${e.style.transform} scale(1.01, 1.01)`,o.reorderEnvelopes(l)},async({itemNode:e})=>{setTimeout((()=>{n(0,r=!1)}),0),e.style.opacity="100%"},()=>M(`${_.EDIT}/new`),e=>!r&&a(e)]}class ee extends e{constructor(e){super(),t(this,e,Z,q,n,{})}}export{ee as default};
