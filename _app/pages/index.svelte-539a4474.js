import{S as ce,i as ie,s as ue,O as N,P as ee,a as I,d as E,b as $,f as W,g as F,H as x,N as q,Q as me,e as L,w as U,k as S,c as O,x as V,m as B,y as X,R as fe,q as z,o as C,B as Y,t as he,h as pe,T as te,U as de,p as ge,V as ve,L as H,W as _e,v as ye,n as xe,X as Ee}from"../chunks/vendor-7e985693.js";import{E as $e}from"../chunks/Envelope-7b65f3be.js";import{B as we}from"../chunks/BottomNavigation-11b00593.js";import{g as se,R as ne,m as be,a as ke,e as Ie}from"../chunks/stores-207dda47.js";import{l as Pe}from"../chunks/longpress-a7a6c534.js";import"../chunks/singletons-d1fb5791.js";function Te(e){let s,t;return{c(){s=N("svg"),t=N("path"),this.h()},l(l){s=ee(l,"svg",{"xmlns:svg":!0,xmlns:!0,viewBox:!0});var f=I(s);t=ee(f,"path",{transform:!0,style:!0,d:!0}),I(t).forEach(E),f.forEach(E),this.h()},h(){$(t,"transform","translate(-84.928348,-118.03593)"),W(t,"fill","currentColor"),W(t,"fill-opacity","1"),W(t,"stroke-width","0.06742518"),$(t,"d","m 101.44525,119.10059 c -0.24265,-0.0583 -0.49278,-0.0771 -0.74024,-0.0567 l -0.972924,4.92984 c 0.01356,-0.006 0.0269,-0.0127 0.04046,-0.0183 0.573884,-0.22252 1.147444,-0.32802 1.721324,-0.31631 0.58559,0.0234 1.15966,0.16395 1.72183,0.4216 0.0792,0.0372 0.15725,0.0769 0.23465,0.11803 0.63679,-0.54903 1.23152,-1.14018 1.78724,-1.77029 l -2.68727,-2.68701 c -0.31688,-0.31689 -0.70067,-0.52372 -1.10508,-0.6209 z m 5.102,4.61781 c -0.60086,0.51094 -1.15816,1.03627 -1.63135,1.58977 0.41277,0.43139 0.74839,0.88241 1.005,1.35286 0.28108,0.51532 0.47428,0.98953 0.57968,1.42286 l -1.739,0.75537 c -0.082,-0.40992 -0.22869,-0.80221 -0.4395,-1.17698 -0.18738,-0.3748 -0.43897,-0.72024 -0.75518,-1.03646 -0.57389,-0.57388 -1.19459,-0.87849 -1.86215,-0.91363 -0.64415,-0.0351 -1.26487,0.24574 -1.862178,0.84305 -0.327932,0.32793 -0.562318,0.66795 -0.702908,1.01927 -0.128815,0.36306 -0.20477,0.73165 -0.228148,1.10644 -0.01172,0.38649 0.01753,0.7789 0.08779,1.17709 0.08197,0.40991 0.16971,0.83735 0.263412,1.28241 0.0937,0.44503 0.175849,0.91354 0.24612,1.40543 0.07027,0.49191 0.07614,0.98984 0.01758,1.49344 -0.03512,0.50361 -0.169966,1.01295 -0.404086,1.52829 -0.210824,0.51533 -0.568096,1.02472 -1.071704,1.52832 -0.456762,0.45675 -0.960228,0.8199 -1.510677,1.08927 -0.550475,0.26936 -1.136098,0.40987 -1.756818,0.4216 -0.59731,0.0117 -1.218077,-0.11734 -1.862221,-0.38671 -0.177586,-0.077 -0.354613,-0.16964 -0.531231,-0.27449 -0.612231,0.55052 -1.236191,1.08931 -1.787843,1.70042 l 2.703134,2.70303 c 0.915628,0.91563 2.390021,0.91547 3.305654,-1.4e-4 l 12.630984,-12.63094 c 0.91563,-0.91564 0.91566,-2.38969 4e-5,-3.30532 z m -9.452901,7.89156 -6.158029,1.21571 -5.23e-4,0.002 c 0.117112,0.4919 0.275481,0.95436 0.474598,1.3877 0.222559,0.4333 0.544268,0.86085 0.965891,1.28247 0.632438,0.63244 1.294392,0.94297 1.985378,0.93125 0.702715,0 1.352507,-0.29898 1.949807,-0.89628 0.316219,-0.31622 0.544566,-0.64976 0.685151,-1.00107 0.140569,-0.35132 0.222559,-0.71453 0.245995,-1.08935 0.03512,-0.36304 0.02355,-0.73781 -0.03501,-1.1243 -0.03538,-0.23351 -0.07341,-0.46984 -0.113072,-0.70761 z m -7.977954,1.57504 -3.180084,0.62767 c -0.05449,0.6599 0.170595,1.33828 0.677615,1.84529 l 2.671718,2.67192 c 0.571755,-0.4906 1.158462,-0.95635 1.663483,-1.55818 -0.499165,-0.51766 -0.885284,-1.03023 -1.155321,-1.53791 -0.292804,-0.55047 -0.497925,-1.0949 -0.615047,-1.63364 -0.0325,-0.138 -0.05294,-0.27745 -0.06236,-0.41515 z"),$(s,"xmlns:svg","http://www.w3.org/2000/svg"),$(s,"xmlns","http://www.w3.org/2000/svg"),$(s,"viewBox","0 0 26 25.999761")},m(l,f){F(l,s,f),x(s,t)},p:q,i:q,o:q,d(l){l&&E(s)}}}class Le extends ce{constructor(s){super();ie(this,s,null,Te,ue,{})}}const le=["touchmove","mousemove"],re=["touchend","mouseup"],j=e=>{var t,l,f,g,o,a,n,m,p,y;const s={x:(o=(f=e.clientX)!=null?f:(l=(t=e.changedTouches)==null?void 0:t[0])==null?void 0:l.clientX)!=null?o:(g=e.detail)==null?void 0:g.clientX,y:(y=(m=e.clientY)!=null?m:(n=(a=e.changedTouches)==null?void 0:a[0])==null?void 0:n.clientY)!=null?y:(p=e.detail)==null?void 0:p.clientY};return s.x!=null&&s.y!=null||console.error("Unable to extract position from the event:",e),s},Oe=(e,{startEvent:s="mousedown",preventClickWhenReleasing:t=!1,onStart:l,onMove:f,onEnd:g}={})=>{let o=Array.from((e==null?void 0:e.children)||[]),a=null,n=null,m=-1,p=null,y={x:0,y:0};const P=i=>u=>{u.stopPropagation(),u.currentTarget.removeEventListener(u.type,P,i)},b=i=>{a=i.currentTarget,t&&i.currentTarget.addEventListener("click",P(!0),!0);const u=a.getBoundingClientRect(),k=j(i);o=Array.from((e==null?void 0:e.children)||[]),a.isDragging=!0,y.x=u.left-i.detail.clientX,y.y=u.top-i.detail.clientY,m=o.findIndex(D=>D===a),n=a.cloneNode(!0),n.style["pointer-events"]="none",n.style["touch-action"]="none",n.style["z-index"]=1,n.style.width=`${a.clientWidth}px`,n.style.height=`${a.clientHeight}px`,n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.transform=`translate(${u.left}px, ${u.top}px)`,e.appendChild(n),l==null||l({event:i,position:k,containerNode:e,itemNodeCopy:n,itemNode:a,itemNodes:o})},v=i=>{if(!n)return;const u=j(i),k={x:u.x+y.x,y:u.y+y.y};o=Array.from((e==null?void 0:e.children)||[]).filter(d=>d!==n),m=o.findIndex(d=>d===a),n.style.transform=`translate(${k.x}px, ${k.y}px)`;const r=document.elementsFromPoint(u.x,u.y).find(d=>(d==null?void 0:d.parentNode)===e&&d!==n);if(r===p)return;const c=o.findIndex(d=>d===r);p=r,c>=0&&m>=0&&m!==c&&(f==null||f({event:i,position:u,fromIndex:m,toIndex:c,toNode:r,containerNode:e,itemNodeCopy:n,itemNode:a,itemNodes:o}),m=c)},A=i=>{if(!n)return;i.stopPropagation(),i.stopImmediatePropagation();const u=j(i);a.style["pointer-events"]="auto",a.style["touch-action"]="auto",a.isDragging=void 0,n.remove(),n=null,g==null||g({event:i,itemNode:a,position:u,containerNode:e,itemNodeCopy:n,itemNodes:o})},h=i=>{i.addEventListener(s,b),le.forEach(u=>window.addEventListener(u,v)),re.forEach(u=>window.addEventListener(u,A))},_=i=>{i.removeEventListener(s,b),le.forEach(u=>i.removeEventListener(u,v)),re.forEach(u=>i.removeEventListener(u,A))};o.forEach(h);const w=i=>{Array.from(i).forEach(k=>{var D;return(D=k.addedNodes)==null?void 0:D.forEach(r=>{o.find(c=>c===r)||(h(r,o.length),o.push(r))})})};return new MutationObserver(w).observe(e,{childList:!0}),{update:()=>{console.error("Parementer updating is not implemented. The dragging behavior will not change.")},destroy:()=>{o.forEach(_)}}};function oe(e,s,t){const l=e.slice();return l[13]=s[t],l}function ae(e,s){let t,l,f,g,o,a;function n(){return s[10](s[13])}return l=new $e({props:{envelope:s[13]}}),l.$on("click",n),{key:e,first:null,c(){t=L("span"),U(l.$$.fragment),f=S(),this.h()},l(m){t=O(m,"SPAN",{class:!0});var p=I(t);V(l.$$.fragment,p),f=B(p),p.forEach(E),this.h()},h(){$(t,"class","cursor-unset outline-none"),this.first=t},m(m,p){F(m,t,p),X(l,t,null),x(t,f),g=!0,o||(a=fe(Pe.call(null,t)),o=!0)},p(m,p){s=m;const y={};p&2&&(y.envelope=s[13]),l.$set(y)},i(m){g||(z(l.$$.fragment,m),g=!0)},o(m){C(l.$$.fragment,m),g=!1},d(m){m&&E(t),Y(l),o=!1,a()}}}function De(e){let s,t,l,f,g,o,a,n,m,p,y,P,b,v=[],A=new Map,h,_,w,T,i,u;f=new Le({}),n=new me({props:{strokeWidth:"2.6",size:"28"}});let k=e[1];const D=r=>r[13]._id;for(let r=0;r<k.length;r+=1){let c=oe(e,k,r),d=D(c);A.set(d,v[r]=ae(d,c))}return w=new we({}),{c(){s=L("div"),t=L("div"),l=L("span"),U(f.$$.fragment),g=S(),o=L("span"),a=L("button"),U(n.$$.fragment),m=S(),p=L("span"),y=he("lopy"),P=S(),b=L("div");for(let r=0;r<v.length;r+=1)v[r].c();h=S(),_=L("div"),U(w.$$.fragment),this.h()},l(r){s=O(r,"DIV",{class:!0});var c=I(s);t=O(c,"DIV",{class:!0});var d=I(t);l=O(d,"SPAN",{class:!0});var Q=I(l);V(f.$$.fragment,Q),Q.forEach(E),g=B(d),o=O(d,"SPAN",{class:!0});var R=I(o);a=O(R,"BUTTON",{class:!0});var G=I(a);V(n.$$.fragment,G),G.forEach(E),m=B(R),p=O(R,"SPAN",{class:!0});var J=I(p);y=pe(J,"lopy"),J.forEach(E),R.forEach(E),d.forEach(E),P=B(c),b=O(c,"DIV",{class:!0});var K=I(b);for(let M=0;M<v.length;M+=1)v[M].l(K);K.forEach(E),h=B(c),_=O(c,"DIV",{class:!0});var Z=I(_);V(w.$$.fragment,Z),Z.forEach(E),c.forEach(E),this.h()},h(){$(l,"class","w-14 cursor-pointer fill-current"),$(a,"class","btn glass btn-circle btn-sm"),$(p,"class","text-4xl font-normal"),$(o,"class","flex items-center space-x-2 whitespace-nowrap"),$(t,"class","font-base col-start-2 col-end-12 flex flex-nowrap items-center justify-around self-start py-14 text-neutral-content"),$(b,"class","col-span-full col-start-2 col-end-12 flex w-full flex-col space-y-3"),$(_,"class","mt-8 col-span-full sticky bottom-0"),$(s,"class","layout-template-rows grid-layout min-h-full svelte-1ewb4ul")},m(r,c){F(r,s,c),x(s,t),x(t,l),X(f,l,null),x(t,g),x(t,o),x(o,a),X(n,a,null),x(o,m),x(o,p),x(p,y),x(s,P),x(s,b);for(let d=0;d<v.length;d+=1)v[d].m(b,null);x(s,h),x(s,_),X(w,_,null),T=!0,i||(u=[te(l,"click",e[8]),te(a,"click",e[9]),fe(Oe.call(null,b,{startEvent:"longpress",onStart:e[5],onMove:e[6],onEnd:e[7]}))],i=!0)},p(r,[c]){c&19&&(k=r[1],xe(),v=de(v,c,D,1,r,k,A,b,Ee,ae,null,oe),ge())},i(r){if(!T){z(f.$$.fragment,r),z(n.$$.fragment,r);for(let c=0;c<k.length;c+=1)z(v[c]);z(w.$$.fragment,r),T=!0}},o(r){C(f.$$.fragment,r),C(n.$$.fragment,r);for(let c=0;c<v.length;c+=1)C(v[c]);C(w.$$.fragment,r),T=!1},d(r){r&&E(s),Y(f),Y(n);for(let c=0;c<v.length;c+=1)v[c].d();Y(w),i=!1,ve(u)}}}function Ae(e,s,t){let l,f,g;H(e,ke,h=>t(12,l=h)),H(e,Ie,h=>t(1,f=h));const o=_e("themeStore");H(e,o,h=>t(2,g=h));let a=!1;const n=h=>{se(`${ne.ENVELOPE}/${h._id}`)},m=({itemNodeCopy:h,itemNode:_})=>{h.style["box-shadow"]="0px 4px 6px -2px rgba(0,0,0,0.8)",h.style.transform=`${h.style.transform} scale(1.01, 1.01)`,_.style.opacity="10%",P.style["overflow-y"]="hidden"},p=({itemNodeCopy:h,fromIndex:_,toIndex:w})=>{t(0,a=!0);const T=be(f,_,w);h.style.transform=`${h.style.transform} scale(1.01, 1.01)`,l.reorderEnvelopes(T)},y=async({itemNode:h})=>{setTimeout(()=>{t(0,a=!1)},0),h.style.opacity="100%",P.style["overflow-y"]="scroll"};let P;return ye(()=>{P=document.getElementsByTagName("main")[0]}),[a,f,g,o,n,m,p,y,()=>{const{currentTheme:h,themes:_}=g,w=_.findIndex(T=>h===T);o.set({themes:_,currentTheme:_[w+1]||_[0]})},()=>se(`${ne.EDIT}/new`),h=>!a&&n(h)]}class Ve extends ce{constructor(s){super();ie(this,s,Ae,De,ue,{})}}export{Ve as default};
