import{S as F,i as Q,s as G,e as I,t as M,k as V,c as P,a as E,h as U,d as v,m as z,b as x,g as R,H as y,M as re,L as S,N as oe,O as J,P as K,f as q,w as X,x as Y,y as W,q as B,o as C,B as j,Q as Z,v as ie,R as ce,T as ae,n as ue,U as fe,p as de,V as pe,W as me}from"../chunks/vendor-b7281c58.js";import{f as he,P as ge,g as N,R as ee,m as ve,a as _e,e as ye}from"../chunks/Page-5cb672c4.js";import{l as xe}from"../chunks/longpress-a7a6c534.js";import"../chunks/singletons-d1fb5791.js";function $e(s){let e,n,t,f,a,o,d,r,i,p=he(s[3])+"",m,g,h;return{c(){e=I("div"),n=I("div"),t=M(s[1]),f=V(),a=I("div"),o=I("div"),d=M(s[2]),r=V(),i=I("div"),m=M(p),this.h()},l(_){e=P(_,"DIV",{id:!0,class:!0});var $=E(e);n=P($,"DIV",{class:!0});var D=E(n);t=U(D,s[1]),D.forEach(v),f=z($),a=P($,"DIV",{class:!0});var w=E(a);o=P(w,"DIV",{class:!0});var A=E(o);d=U(A,s[2]),A.forEach(v),r=z(w),i=P(w,"DIV",{class:!0});var c=E(i);m=U(c,p),c.forEach(v),w.forEach(v),$.forEach(v),this.h()},h(){x(n,"class","text-3xl self-center"),x(o,"class","text-base truncate"),x(i,"class","font-mono text-sm text-content opacity-70"),x(a,"class","text-dark font-semibold flex flex-col truncate"),x(e,"id",s[0]),x(e,"class","flex overflow-visible bg-base-100 p-4 border-box space-x-2 rounded-3xl")},m(_,$){R(_,e,$),y(e,n),y(n,t),y(e,f),y(e,a),y(a,o),y(o,d),y(a,r),y(a,i),y(i,m),g||(h=re(e,"click",s[5]),g=!0)},p:S,i:S,o:S,d(_){_&&v(e),g=!1,h()}}}function Ee(s,e,n){let{envelope:t}=e,{_id:f,emoji:a,name:o,value:d}=t;function r(i){oe.call(this,s,i)}return s.$$set=i=>{"envelope"in i&&n(4,t=i.envelope)},[f,a,o,d,t,r]}class we extends F{constructor(e){super();Q(this,e,Ee,$e,G,{envelope:4})}}function be(s){let e,n;return{c(){e=J("svg"),n=J("path"),this.h()},l(t){e=K(t,"svg",{"xmlns:svg":!0,xmlns:!0,viewBox:!0});var f=E(e);n=K(f,"path",{transform:!0,style:!0,d:!0}),E(n).forEach(v),f.forEach(v),this.h()},h(){x(n,"transform","translate(-84.928348,-118.03593)"),q(n,"fill","currentColor"),q(n,"fill-opacity","1"),q(n,"stroke-width","0.06742518"),x(n,"d","m 101.44525,119.10059 c -0.24265,-0.0583 -0.49278,-0.0771 -0.74024,-0.0567 l -0.972924,4.92984 c 0.01356,-0.006 0.0269,-0.0127 0.04046,-0.0183 0.573884,-0.22252 1.147444,-0.32802 1.721324,-0.31631 0.58559,0.0234 1.15966,0.16395 1.72183,0.4216 0.0792,0.0372 0.15725,0.0769 0.23465,0.11803 0.63679,-0.54903 1.23152,-1.14018 1.78724,-1.77029 l -2.68727,-2.68701 c -0.31688,-0.31689 -0.70067,-0.52372 -1.10508,-0.6209 z m 5.102,4.61781 c -0.60086,0.51094 -1.15816,1.03627 -1.63135,1.58977 0.41277,0.43139 0.74839,0.88241 1.005,1.35286 0.28108,0.51532 0.47428,0.98953 0.57968,1.42286 l -1.739,0.75537 c -0.082,-0.40992 -0.22869,-0.80221 -0.4395,-1.17698 -0.18738,-0.3748 -0.43897,-0.72024 -0.75518,-1.03646 -0.57389,-0.57388 -1.19459,-0.87849 -1.86215,-0.91363 -0.64415,-0.0351 -1.26487,0.24574 -1.862178,0.84305 -0.327932,0.32793 -0.562318,0.66795 -0.702908,1.01927 -0.128815,0.36306 -0.20477,0.73165 -0.228148,1.10644 -0.01172,0.38649 0.01753,0.7789 0.08779,1.17709 0.08197,0.40991 0.16971,0.83735 0.263412,1.28241 0.0937,0.44503 0.175849,0.91354 0.24612,1.40543 0.07027,0.49191 0.07614,0.98984 0.01758,1.49344 -0.03512,0.50361 -0.169966,1.01295 -0.404086,1.52829 -0.210824,0.51533 -0.568096,1.02472 -1.071704,1.52832 -0.456762,0.45675 -0.960228,0.8199 -1.510677,1.08927 -0.550475,0.26936 -1.136098,0.40987 -1.756818,0.4216 -0.59731,0.0117 -1.218077,-0.11734 -1.862221,-0.38671 -0.177586,-0.077 -0.354613,-0.16964 -0.531231,-0.27449 -0.612231,0.55052 -1.236191,1.08931 -1.787843,1.70042 l 2.703134,2.70303 c 0.915628,0.91563 2.390021,0.91547 3.305654,-1.4e-4 l 12.630984,-12.63094 c 0.91563,-0.91564 0.91566,-2.38969 4e-5,-3.30532 z m -9.452901,7.89156 -6.158029,1.21571 -5.23e-4,0.002 c 0.117112,0.4919 0.275481,0.95436 0.474598,1.3877 0.222559,0.4333 0.544268,0.86085 0.965891,1.28247 0.632438,0.63244 1.294392,0.94297 1.985378,0.93125 0.702715,0 1.352507,-0.29898 1.949807,-0.89628 0.316219,-0.31622 0.544566,-0.64976 0.685151,-1.00107 0.140569,-0.35132 0.222559,-0.71453 0.245995,-1.08935 0.03512,-0.36304 0.02355,-0.73781 -0.03501,-1.1243 -0.03538,-0.23351 -0.07341,-0.46984 -0.113072,-0.70761 z m -7.977954,1.57504 -3.180084,0.62767 c -0.05449,0.6599 0.170595,1.33828 0.677615,1.84529 l 2.671718,2.67192 c 0.571755,-0.4906 1.158462,-0.95635 1.663483,-1.55818 -0.499165,-0.51766 -0.885284,-1.03023 -1.155321,-1.53791 -0.292804,-0.55047 -0.497925,-1.0949 -0.615047,-1.63364 -0.0325,-0.138 -0.05294,-0.27745 -0.06236,-0.41515 z"),x(e,"xmlns:svg","http://www.w3.org/2000/svg"),x(e,"xmlns","http://www.w3.org/2000/svg"),x(e,"viewBox","0 0 26 25.999761")},m(t,f){R(t,e,f),y(e,n)},p:S,i:S,o:S,d(t){t&&v(e)}}}class ke extends F{constructor(e){super();Q(this,e,null,be,G,{})}}const te=["touchmove","mousemove"],se=["touchend","mouseup"],H=s=>{var n,t,f,a,o,d,r,i,p,m;const e={x:(o=(f=s.clientX)!=null?f:(t=(n=s.changedTouches)==null?void 0:n[0])==null?void 0:t.clientX)!=null?o:(a=s.detail)==null?void 0:a.clientX,y:(m=(i=s.clientY)!=null?i:(r=(d=s.changedTouches)==null?void 0:d[0])==null?void 0:r.clientY)!=null?m:(p=s.detail)==null?void 0:p.clientY};return e.x!=null&&e.y!=null||console.error("Unable to extract position from the event:",s),e},Ie=(s,{startEvent:e="mousedown",preventClickWhenReleasing:n=!1,onStart:t,onMove:f,onEnd:a}={})=>{let o=Array.from((s==null?void 0:s.children)||[]),d=null,r=null,i=-1,p=null,m={x:0,y:0};const g=l=>u=>{u.stopPropagation(),u.currentTarget.removeEventListener(u.type,g,l)},h=l=>{d=l.currentTarget,n&&l.currentTarget.addEventListener("click",g(!0),!0);const u=d.getBoundingClientRect(),b=H(l);o=Array.from((s==null?void 0:s.children)||[]),d.isDragging=!0,m.x=u.left-l.detail.clientX,m.y=u.top-l.detail.clientY,i=o.findIndex(T=>T===d),r=d.cloneNode(!0),r.style["pointer-events"]="none",r.style["touch-action"]="none",r.style["z-index"]=1,r.style.width=`${d.clientWidth}px`,r.style.height=`${d.clientHeight}px`,r.style.position="fixed",r.style.top=0,r.style.left=0,r.style.transform=`translate(${u.left}px, ${u.top}px)`,s.appendChild(r),t==null||t({event:l,position:b,containerNode:s,itemNodeCopy:r,itemNode:d,itemNodes:o})},_=l=>{if(!r)return;const u=H(l),b={x:u.x+m.x,y:u.y+m.y};o=Array.from((s==null?void 0:s.children)||[]).filter(O=>O!==r),i=o.findIndex(O=>O===d),r.style.transform=`translate(${b.x}px, ${b.y}px)`;const k=document.elementsFromPoint(u.x,u.y).find(O=>(O==null?void 0:O.parentNode)===s&&O!==r);if(k===p)return;const L=o.findIndex(O=>O===k);p=k,L>=0&&i>=0&&i!==L&&(f==null||f({event:l,position:u,fromIndex:i,toIndex:L,toNode:k,containerNode:s,itemNodeCopy:r,itemNode:d,itemNodes:o}),i=L)},$=l=>{if(!r)return;l.stopPropagation(),l.stopImmediatePropagation();const u=H(l);d.style["pointer-events"]="auto",d.style["touch-action"]="auto",d.isDragging=void 0,r.remove(),r=null,a==null||a({event:l,itemNode:d,position:u,containerNode:s,itemNodeCopy:r,itemNodes:o})},D=l=>{l.addEventListener(e,h),te.forEach(u=>window.addEventListener(u,_)),se.forEach(u=>window.addEventListener(u,$))},w=l=>{l.removeEventListener(e,h),te.forEach(u=>l.removeEventListener(u,_)),se.forEach(u=>l.removeEventListener(u,$))};o.forEach(D);const A=l=>{Array.from(l).forEach(b=>{var T;return(T=b.addedNodes)==null?void 0:T.forEach(k=>{o.find(L=>L===k)||(D(k,o.length),o.push(k))})})};return new MutationObserver(A).observe(s,{childList:!0}),{update:()=>{console.error("Parementer updating is not implemented. The dragging behavior will not change.")},destroy:()=>{o.forEach(w)}}};function ne(s,e,n){const t=s.slice();return t[10]=e[n],t}function le(s,e){let n,t,f,a,o,d;function r(){return e[7](e[10])}return t=new we({props:{envelope:e[10]}}),t.$on("click",r),{key:s,first:null,c(){n=I("span"),X(t.$$.fragment),f=V(),this.h()},l(i){n=P(i,"SPAN",{class:!0});var p=E(n);Y(t.$$.fragment,p),f=z(p),p.forEach(v),this.h()},h(){x(n,"class","outline-none cursor-unset"),this.first=n},m(i,p){R(i,n,p),W(t,n,null),y(n,f),a=!0,o||(d=ae(xe.call(null,n)),o=!0)},p(i,p){e=i;const m={};p&2&&(m.envelope=e[10]),t.$set(m)},i(i){a||(B(t.$$.fragment,i),a=!0)},o(i){C(t.$$.fragment,i),a=!1},d(i){i&&v(n),j(t),o=!1,d()}}}function Pe(s){let e,n,t,f,a,o,d,r,i,p,m,g=[],h=new Map,_,$,D;t=new ke({}),o=new ce({props:{strokeWidth:"2.7",size:"28"}});let w=s[1];const A=c=>c[10]._id;for(let c=0;c<w.length;c+=1){let l=ne(s,w,c),u=A(l);h.set(u,g[c]=le(u,l))}return{c(){e=I("div"),n=I("span"),X(t.$$.fragment),f=V(),a=I("span"),X(o.$$.fragment),d=V(),r=I("span"),i=M("lopy"),p=V(),m=I("div");for(let c=0;c<g.length;c+=1)g[c].c();this.h()},l(c){e=P(c,"DIV",{class:!0});var l=E(e);n=P(l,"SPAN",{class:!0});var u=E(n);Y(t.$$.fragment,u),u.forEach(v),f=z(l),a=P(l,"SPAN",{class:!0});var b=E(a);Y(o.$$.fragment,b),d=z(b),r=P(b,"SPAN",{class:!0});var T=E(r);i=U(T,"lopy"),T.forEach(v),b.forEach(v),l.forEach(v),p=z(c),m=P(c,"DIV",{class:!0});var k=E(m);for(let L=0;L<g.length;L+=1)g[L].l(k);k.forEach(v),this.h()},h(){x(n,"class","w-14 fill-current"),x(r,"class","text-4xl font-normal"),x(a,"class","cursor-pointer whitespace-nowrap flex space-x-2 items-center"),x(e,"class","opacity-70 flex items-center justify-around flex-nowrap font-base mx-4 px-4 py-6"),x(m,"class","w-full p-4 flex flex-col space-y-3")},m(c,l){R(c,e,l),y(e,n),W(t,n,null),y(e,f),y(e,a),W(o,a,null),y(a,d),y(a,r),y(r,i),R(c,p,l),R(c,m,l);for(let u=0;u<g.length;u+=1)g[u].m(m,null);_=!0,$||(D=[re(a,"click",s[6]),ae(Ie.call(null,m,{startEvent:"longpress",onStart:s[3],onMove:s[4],onEnd:s[5]}))],$=!0)},p(c,l){l&7&&(w=c[1],ue(),g=fe(g,l,A,1,c,w,h,m,me,le,null,ne),de())},i(c){if(!_){B(t.$$.fragment,c),B(o.$$.fragment,c);for(let l=0;l<w.length;l+=1)B(g[l]);_=!0}},o(c){C(t.$$.fragment,c),C(o.$$.fragment,c);for(let l=0;l<g.length;l+=1)C(g[l]);_=!1},d(c){c&&v(e),j(t),j(o),c&&v(p),c&&v(m);for(let l=0;l<g.length;l+=1)g[l].d();$=!1,pe(D)}}}function De(s){let e,n;return e=new ge({props:{$$slots:{default:[Pe]},$$scope:{ctx:s}}}),{c(){X(e.$$.fragment)},l(t){Y(e.$$.fragment,t)},m(t,f){W(e,t,f),n=!0},p(t,[f]){const a={};f&8195&&(a.$$scope={dirty:f,ctx:t}),e.$set(a)},i(t){n||(B(e.$$.fragment,t),n=!0)},o(t){C(e.$$.fragment,t),n=!1},d(t){j(e,t)}}}function Le(s,e,n){let t,f;Z(s,_e,h=>n(9,t=h)),Z(s,ye,h=>n(1,f=h));let a=!1;const o=h=>{N(`${ee.ENVELOPE}/${h._id}`)},d=({itemNodeCopy:h,itemNode:_})=>{h.style["box-shadow"]="0px 4px 6px -2px rgba(0,0,0,0.8)",h.style.transform=`${h.style.transform} scale(1.01, 1.01)`,_.style.opacity="10%",p.style["overflow-y"]="hidden"},r=({itemNodeCopy:h,fromIndex:_,toIndex:$})=>{n(0,a=!0);const D=ve(f,_,$);h.style.transform=`${h.style.transform} scale(1.01, 1.01)`,t.reorderEnvelopes(D)},i=async({itemNode:h})=>{setTimeout(()=>{n(0,a=!1)},0),h.style.opacity="100%",p.style["overflow-y"]="scroll"};let p;return ie(()=>{p=document.getElementsByTagName("main")[0]}),[a,f,o,d,r,i,()=>N(`${ee.EDIT}/new`),h=>!a&&o(h)]}class ze extends F{constructor(e){super();Q(this,e,Le,De,G,{})}}export{ze as default};
