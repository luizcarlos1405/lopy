var Be=Object.defineProperty,Pe=Object.defineProperties;var Ce=Object.getOwnPropertyDescriptors;var te=Object.getOwnPropertySymbols;var de=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var pe=(t,e,n)=>e in t?Be(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,le=(t,e)=>{for(var n in e||(e={}))de.call(e,n)&&pe(t,n,e[n]);if(te)for(var n of te(e))me.call(e,n)&&pe(t,n,e[n]);return t},oe=(t,e)=>Pe(t,Ce(e));var ie=(t,e)=>{var n={};for(var s in t)de.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&te)for(var s of te(t))e.indexOf(s)<0&&me.call(t,s)&&(n[s]=t[s]);return n};import{S as we,i as Te,s as Ee,ap as Ae,R as De,e as C,w as W,k as U,c as A,a as R,x as X,m as q,d as v,b as w,a0 as G,g as V,H as E,y as Y,an as Z,M as z,q as M,o as O,B as F,V as ue,aq as Re,al as J,Q as re,a7 as _e,t as x,h as ee,a8 as Me,n as Ie,p as Ne,ar as he,L as N,am as ne,ao as se,a1 as Se,a9 as ge,as as ze,at as Oe,a6 as be}from"../../chunks/vendor-b7281c58.js";import{f as ve,s as Ve,P as Ue,i as qe,C as ke,e as je,a as Le,p as He}from"../../chunks/Page-5cb672c4.js";import{E as We}from"../../chunks/EnvelopeTransactions-858a9c26.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/longpress-a7a6c534.js";function Xe(t){let e,n,s,a,l,u,r,o,d,T;return s=new Ae({props:{class:"swap-on",size:"24"}}),l=new De({props:{class:"swap-off",size:"24"}}),{c(){e=C("div"),n=C("div"),W(s.$$.fragment),a=U(),W(l.$$.fragment),u=U(),r=C("input"),this.h()},l(m){e=A(m,"DIV",{class:!0});var c=R(e);n=A(c,"DIV",{class:!0});var _=R(n);X(s.$$.fragment,_),a=q(_),X(l.$$.fragment,_),_.forEach(v),u=q(c),r=A(c,"INPUT",{class:!0,inputmode:!0}),c.forEach(v),this.h()},h(){w(n,"class","swap swap-rotate relative cursor-pointer p-1 svelte-10b1agz"),G(n,"minus",t[2]),G(n,"plus",!t[2]),w(r,"class","input-xs reset-input font-mono flex-grow"),r.autofocus=!0,w(r,"inputmode","numeric"),w(e,"class","flex items-center overflow-clip text-neutral-content w-full min-h-max bg-base-100 rounded-full")},m(m,c){V(m,e,c),E(e,n),Y(s,n,null),E(n,a),Y(l,n,null),E(e,u),E(e,r),Z(r,t[3]),t[9](r),o=!0,r.focus(),d||(T=[z(n,"click",t[7]),z(r,"change",t[5]),z(r,"selectionchange",t[6]),z(r,"input",t[8]),z(r,"input",t[5]),z(r,"keyup",t[4])],d=!0)},p(m,[c]){c&4&&G(n,"minus",m[2]),c&4&&G(n,"plus",!m[2]),c&8&&r.value!==m[3]&&Z(r,m[3])},i(m){o||(M(s.$$.fragment,m),M(l.$$.fragment,m),o=!0)},o(m){O(s.$$.fragment,m),O(l.$$.fragment,m),o=!1},d(m){m&&v(e),F(s),F(l),t[9](null),d=!1,ue(T)}}}function Ye(t,e,n){let{inputRef:s=null}=e,{value:a=0}=e,{isNegative:l=!1}=e;const u=Re();let r=ve(a);const o=({key:h})=>{h==="Enter"&&u("enterPressed")},d=h=>{h.preventDefault();const P=+`${Ve(r)}`;n(1,a=l?-P:P),n(3,r=ve(Math.abs(a),{showSign:!1}))},T=h=>{const P=h.target.value.length;h.target.selectionEnd=P,h.target.selectionStart=P},m=()=>{n(2,l=!l),n(1,a=l?-Math.abs(a):Math.abs(a)),s==null||s.focus()};function c(){r=this.value,n(3,r)}function _(h){J[h?"unshift":"push"](()=>{s=h,n(0,s)})}return t.$$set=h=>{"inputRef"in h&&n(0,s=h.inputRef),"value"in h&&n(1,a=h.value),"isNegative"in h&&n(2,l=h.isNegative)},[s,a,l,r,o,d,T,m,c,_]}class Fe extends we{constructor(e){super();Te(this,e,Ye,Xe,Ee,{inputRef:0,value:1,isNegative:2})}}function Ke(t){return{c:N,l:N,m:N,p:N,i:N,o:N,d:N}}function Qe(t){let e,n,s;function a(u){t[15](u)}let l={transactions:t[27]};return t[5]!==void 0&&(l.selectedTransactionsById=t[5]),e=new We({props:l}),J.push(()=>ne(e,"selectedTransactionsById",a)),{c(){W(e.$$.fragment)},l(u){X(e.$$.fragment,u)},m(u,r){Y(e,u,r),s=!0},p(u,r){const o={};r&16&&(o.transactions=u[27]),!n&&r&32&&(n=!0,o.selectedTransactionsById=u[5],se(()=>n=!1)),e.$set(o)},i(u){s||(M(e.$$.fragment,u),s=!0)},o(u){O(e.$$.fragment,u),s=!1},d(u){F(e,u)}}}function Ge(t){return{c:N,l:N,m:N,p:N,i:N,o:N,d:N}}function Je(t){var H;let e,n=t[1]||((H=Object.keys(t[5]))==null?void 0:H.length),s,a,l,u,r,o,d,T,m,c,_,h,P,B,f=n&&ye(t);l=new ze({props:{size:"20",strokeWidth:"3"}});function D(i){t[18](i)}function I(i){t[19](i)}function j(i){t[20](i)}let b={};return t[7]!==void 0&&(b.isNegative=t[7]),t[6].value!==void 0&&(b.value=t[6].value),t[3]!==void 0&&(b.inputRef=t[3]),o=new Fe({props:b}),J.push(()=>ne(o,"isNegative",D)),J.push(()=>ne(o,"value",I)),J.push(()=>ne(o,"inputRef",j)),o.$on("enterPressed",t[9]),{c(){e=C("div"),f&&f.c(),s=U(),a=C("button"),W(l.$$.fragment),u=x(`
          Paste`),r=U(),W(o.$$.fragment),c=U(),_=C("textarea"),this.h()},l(i){e=A(i,"DIV",{class:!0});var k=R(e);f&&f.l(k),s=q(k),a=A(k,"BUTTON",{class:!0});var g=R(a);X(l.$$.fragment,g),u=ee(g,`
          Paste`),g.forEach(v),k.forEach(v),r=q(i),X(o.$$.fragment,i),c=q(i),_=A(i,"TEXTAREA",{id:!0,rows:!0,class:!0,placeholder:!0}),R(_).forEach(v),this.h()},h(){w(a,"class","text-dark inline-flex gap-2 items-center font-bold rounded-full py-2 px-2"),w(e,"class","inline-flex self-end gap-4"),w(_,"id","comment-input"),w(_,"rows","3"),w(_,"class","textarea ease-linear leading-4 resize-none"),w(_,"placeholder","Description")},m(i,k){V(i,e,k),f&&f.m(e,null),E(e,s),E(e,a),Y(l,a,null),E(a,u),V(i,r,k),Y(o,i,k),V(i,c,k),V(i,_,k),Z(_,t[6].comment),h=!0,P||(B=[z(a,"click",t[13]),z(_,"input",t[21])],P=!0)},p(i,k){var y;k&34&&(n=i[1]||((y=Object.keys(i[5]))==null?void 0:y.length)),n?f?(f.p(i,k),k&34&&M(f,1)):(f=ye(i),f.c(),M(f,1),f.m(e,s)):f&&(Ie(),O(f,1,1,()=>{f=null}),Ne());const g={};!d&&k&128&&(d=!0,g.isNegative=i[7],se(()=>d=!1)),!T&&k&64&&(T=!0,g.value=i[6].value,se(()=>T=!1)),!m&&k&8&&(m=!0,g.inputRef=i[3],se(()=>m=!1)),o.$set(g),k&64&&Z(_,i[6].comment)},i(i){h||(M(f),M(l.$$.fragment,i),M(o.$$.fragment,i),h=!0)},o(i){O(f),O(l.$$.fragment,i),O(o.$$.fragment,i),h=!1},d(i){i&&v(e),f&&f.d(),F(l),i&&v(r),F(o,i),i&&v(c),i&&v(_),P=!1,ue(B)}}}function Ze(t){let e,n,s;return{c(){e=C("textarea"),this.h()},l(a){e=A(a,"TEXTAREA",{id:!0,rows:!0,class:!0,placeholder:!0}),R(e).forEach(v),this.h()},h(){w(e,"id","comment-input"),w(e,"rows","7"),w(e,"class","textarea ease-linear leading-4 resize-none self-stretch"),w(e,"placeholder","Transaction values")},m(a,l){V(a,e,l),Z(e,t[8]),t[17](e),n||(s=z(e,"input",t[16]),n=!0)},p(a,l){l&256&&Z(e,a[8])},i:N,o:N,d(a){a&&v(e),t[17](null),n=!1,s()}}}function ye(t){let e,n,s,a,l,u,r;return n=new Oe({props:{size:"20",strokeWidth:"3"}}),{c(){e=C("button"),W(n.$$.fragment),s=x(`
            Copy`),this.h()},l(o){e=A(o,"BUTTON",{class:!0});var d=R(e);X(n.$$.fragment,d),s=ee(d,`
            Copy`),d.forEach(v),this.h()},h(){w(e,"class","text-dark inline-flex gap-2 items-center font-bold rounded-full py-2 px-2")},m(o,d){V(o,e,d),Y(n,e,null),E(e,s),l=!0,u||(r=z(e,"click",t[12]),u=!0)},p:N,i(o){l||(M(n.$$.fragment,o),o&&Se(()=>{a||(a=ge(e,be,{duration:300},!0)),a.run(1)}),l=!0)},o(o){O(n.$$.fragment,o),o&&(a||(a=ge(e,be,{duration:300},!1)),a.run(0)),l=!1},d(o){o&&v(e),F(n),o&&a&&a.end(),u=!1,r()}}}function $e(t){let e,n,s,a,l,u,r,o,d,T,m,c,_,h,P,B,f,D,I,j,b={ctx:t,current:null,token:null,hasCatch:!1,pending:Ge,then:Qe,catch:Ke,value:27,blocks:[,,,]};_e(n=t[4].transactions,b);const H=[Ze,Je],i=[];function k(g,y){return g[2]?0:1}return l=k(t),u=i[l]=H[l](t),{c(){e=C("div"),b.block.c(),s=U(),a=C("div"),u.c(),r=U(),o=C("div"),d=C("button"),T=x("Back"),m=U(),c=C("button"),_=C("span"),h=x("Remove"),P=U(),B=C("span"),f=x("Add"),this.h()},l(g){e=A(g,"DIV",{class:!0});var y=R(e);b.block.l(y),y.forEach(v),s=q(g),a=A(g,"DIV",{class:!0});var S=R(a);u.l(S),r=q(S),o=A(S,"DIV",{class:!0});var K=R(o);d=A(K,"BUTTON",{class:!0});var p=R(d);T=ee(p,"Back"),p.forEach(v),m=q(K),c=A(K,"BUTTON",{class:!0});var Q=R(c);_=A(Q,"SPAN",{class:!0});var $=R(_);h=ee($,"Remove"),$.forEach(v),P=q(Q),B=A(Q,"SPAN",{class:!0});var L=R(B);f=ee(L,"Add"),L.forEach(v),Q.forEach(v),K.forEach(v),S.forEach(v),this.h()},h(){w(e,"class","pb-14"),w(d,"class","btn btn-outline w-22"),w(_,"class","swap-on"),w(B,"class","swap-off"),w(c,"class","swap btn btn-primary w-22 svelte-1qr6ziz"),G(c,"swapActive",t[7]&&!t[2]),w(o,"class","flex justify-around"),w(a,"class","sticky mt-auto mx-4 bottom-4 border border-neutral-focus left-4 right-4 box-border flex flex-col space-y-4 bg-base-300 rounded-3xl p-6")},m(g,y){V(g,e,y),b.block.m(e,b.anchor=null),b.mount=()=>e,b.anchor=null,V(g,s,y),V(g,a,y),i[l].m(a,null),E(a,r),E(a,o),E(o,d),E(d,T),E(o,m),E(o,c),E(c,_),E(_,h),E(c,P),E(c,B),E(B,f),D=!0,I||(j=[z(d,"click",t[11]),z(c,"click",t[10])],I=!0)},p(g,y){t=g,b.ctx=t,y&16&&n!==(n=t[4].transactions)&&_e(n,b)||Me(b,t,y);let S=l;l=k(t),l===S?i[l].p(t,y):(Ie(),O(i[S],1,1,()=>{i[S]=null}),Ne(),u=i[l],u?u.p(t,y):(u=i[l]=H[l](t),u.c()),M(u,1),u.m(a,r)),y&132&&G(c,"swapActive",t[7]&&!t[2])},i(g){D||(M(b.block),M(u),D=!0)},o(g){for(let y=0;y<3;y+=1){const S=b.blocks[y];O(S)}O(u),D=!1},d(g){g&&v(e),b.block.d(),b.token=null,b=null,g&&v(s),g&&v(a),i[l].d(),I=!1,ue(j)}}}function xe(t){let e,n;return e=new Ue({props:{hideBottomNavigation:!0,$$slots:{default:[$e]},$$scope:{ctx:t}}}),{c(){W(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,a){Y(e,s,a),n=!0},p(s,[a]){const l={};a&268435967&&(l.$$scope={dirty:a,ctx:s}),e.$set(l)},i(s){n||(M(e.$$.fragment,s),n=!0)},o(s){O(e.$$.fragment,s),n=!1},d(s){F(e,s)}}}function et(t,e,n){let s,a,l,u;re(t,je,p=>n(14,a=p)),re(t,Le,p=>n(23,l=p)),re(t,He,p=>n(24,u=p));const{id:r}=u.params;let o=null,d=null,T=!1;const m=()=>{document==null||document.getElementById("comment-input").focus()},c=()=>{if(T){const p=he.parse(b);n(8,b=""),n(2,T=!1),p==null||p.forEach(ae=>{var fe=ae,{envelope:Q,value:$,date:L}=fe,ce=ie(fe,["envelope","value","date"]);l.saveTransaction(oe(le({},ce),{value:$*100,date:DateTime.fromFormat(L,ke).toSeconds()}),r).then(async()=>{n(5,D={}),n(4,f=await f.refresh())})});return}qe()&&I.value&&l.saveTransaction(I,r).then(async p=>{n(6,I.value=0,I),n(6,I.comment="",I),n(4,f=await f.refresh()),B==null||B.focus(),n(1,d=p),n(5,D={})})},_=()=>{if(T){n(2,T=!1);return}window.history.back()},h=()=>{const p=d?[d]:Object.values(D);navigator.clipboard.writeText(he.stringify(p.map(ce=>{var ae=ce,{envelopeId:Q,_id:$}=ae,L=ie(ae,["envelopeId","_id"]);return oe(le({envelope:s==null?void 0:s.name},L),{value:L.value/100,date:DateTime.fromSeconds(L.date).toFormat(ke)})}))).then(()=>{n(1,d=null),n(5,D={})}).catch(console.error)},P=async()=>{n(2,T=!0),o==null||o.focus()};let B,f=l?l.getTransactionsPaginated({actions:l,envelopeId:r}):{},D={},I={value:0,comment:""},j=!0,b="";function H(p){D=p,n(5,D)}function i(){b=this.value,n(8,b)}function k(p){J[p?"unshift":"push"](()=>{o=p,n(0,o)})}function g(p){j=p,n(7,j)}function y(p){t.$$.not_equal(I.value,p)&&(I.value=p,n(6,I))}function S(p){B=p,n(3,B)}function K(){I.comment=this.value,n(6,I)}return t.$$.update=()=>{t.$$.dirty&16384&&(s=a.find(({_id:p})=>p===r))},[o,d,T,B,f,D,I,j,b,m,c,_,h,P,a,H,i,k,g,y,S,K]}class it extends we{constructor(e){super();Te(this,e,et,xe,Ee,{})}}export{it as default};
