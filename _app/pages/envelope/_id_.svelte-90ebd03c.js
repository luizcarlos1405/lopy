var je=Object.defineProperty,Le=Object.defineProperties;var qe=Object.getOwnPropertyDescriptors;var pe=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable;var we=(n,e,t)=>e in n?je(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,he=(n,e)=>{for(var t in e||(e={}))Te.call(e,t)&&we(n,t,e[t]);if(pe)for(var t of pe(e))Ee.call(e,t)&&we(n,t,e[t]);return n},be=(n,e)=>Le(n,qe(e));var ge=(n,e)=>{var t={};for(var o in n)Te.call(n,o)&&e.indexOf(o)<0&&(t[o]=n[o]);if(n!=null&&pe)for(var o of pe(n))e.indexOf(o)<0&&Ee.call(n,o)&&(t[o]=n[o]);return t};import{S as Re,i as ze,s as Ve,ar as We,Q as He,e as N,w as H,k as M,c as B,a as O,x as X,m as R,d as k,b as T,a2 as Z,g as W,H as w,y as Y,ap as se,T as P,q as E,o as A,B as F,V as ke,as as Xe,M as x,t as te,h as ne,p as _e,L as de,n as me,at as Ie,a6 as Ne,a7 as Be,l as Oe,a8 as Ye,ao as oe,aq as re,N as S,ac as Fe,au as Ae,av as Ke,an as Qe,aw as Ge,ai as Se}from"../../chunks/vendor-c0a95dcb.js";import{f as Je,s as Ze,i as $e,C as Ce,a as xe,e as et,p as tt}from"../../chunks/stores-2000987a.js";import{E as Ue}from"../../chunks/EnvelopeTransactions-262cad4c.js";import{E as nt}from"../../chunks/Envelope-f11463df.js";import{f as st,a as Pe,s as at,n as lt}from"../../chunks/notionStore-26f6cc43.js";import"../../chunks/singletons-d1fb5791.js";import"../../chunks/longpress-a7a6c534.js";function ot(n){let e,t,o,r,a,s,l,p,m,u;return o=new We({props:{class:"swap-on",size:"24"}}),a=new He({props:{class:"swap-off",size:"24"}}),{c(){e=N("div"),t=N("div"),H(o.$$.fragment),r=M(),H(a.$$.fragment),s=M(),l=N("input"),this.h()},l(f){e=B(f,"DIV",{class:!0});var d=O(e);t=B(d,"DIV",{class:!0});var g=O(t);X(o.$$.fragment,g),r=R(g),X(a.$$.fragment,g),g.forEach(k),s=R(d),l=B(d,"INPUT",{class:!0,inputmode:!0}),d.forEach(k),this.h()},h(){T(t,"class","swap swap-rotate relative cursor-pointer p-1 svelte-19elewz"),Z(t,"minus",n[2]),Z(t,"plus",!n[2]),T(l,"class","reset-input font-mono input-xs flex-grow text-base-content"),l.autofocus=!0,T(l,"inputmode","numeric"),T(e,"class","flex min-h-max w-full items-center overflow-clip rounded-full bg-base-200 text-neutral-content")},m(f,d){W(f,e,d),w(e,t),Y(o,t,null),w(t,r),Y(a,t,null),w(e,s),w(e,l),se(l,n[3]),n[9](l),p=!0,l.focus(),m||(u=[P(t,"click",n[7]),P(l,"change",n[5]),P(l,"selectionchange",n[6]),P(l,"input",n[8]),P(l,"input",n[5]),P(l,"keyup",n[4])],m=!0)},p(f,[d]){d&4&&Z(t,"minus",f[2]),d&4&&Z(t,"plus",!f[2]),d&8&&l.value!==f[3]&&se(l,f[3])},i(f){p||(E(o.$$.fragment,f),E(a.$$.fragment,f),p=!0)},o(f){A(o.$$.fragment,f),A(a.$$.fragment,f),p=!1},d(f){f&&k(e),F(o),F(a),n[9](null),m=!1,ke(u)}}}function rt(n,e,t){let o,{inputRef:r=null}=e,{value:a=0}=e,{isNegative:s=!1}=e;const l=Xe(),p=({key:i})=>{i==="Enter"&&l("enterPressed")},m=i=>{i.preventDefault();const h=+`${Ze(o)}`;t(0,a=s?-h:h)},u=i=>{const h=i.target.value.length;i.target.selectionEnd=h,i.target.selectionStart=h},f=()=>{t(2,s=!s),t(0,a=s?-Math.abs(a):Math.abs(a)),r==null||r.focus()};function d(){o=this.value,t(3,o),t(0,a)}function g(i){x[i?"unshift":"push"](()=>{r=i,t(1,r)})}return n.$$set=i=>{"inputRef"in i&&t(1,r=i.inputRef),"value"in i&&t(0,a=i.value),"isNegative"in i&&t(2,s=i.isNegative)},n.$$.update=()=>{n.$$.dirty&1&&t(3,o=Je(Math.abs(a),{showSign:!1}))},[a,r,s,o,p,m,u,f,d,g]}class it extends Re{constructor(e){super();ze(this,e,rt,ot,Ve,{inputRef:1,value:0,isNegative:2})}}function ct(n){let e,t,o,r={ctx:n,current:null,token:null,hasCatch:!1,pending:dt,then:pt,catch:ft,value:31,blocks:[,,,]};return Be(t=n[5].transactions,r),{c(){e=Oe(),r.block.c()},l(a){e=Oe(),r.block.l(a)},m(a,s){W(a,e,s),r.block.m(a,r.anchor=s),r.mount=()=>e.parentNode,r.anchor=e,o=!0},p(a,s){n=a,r.ctx=n,s[0]&32&&t!==(t=n[5].transactions)&&Be(t,r)||Ye(r,n,s)},i(a){o||(E(r.block),o=!0)},o(a){for(let s=0;s<3;s+=1){const l=r.blocks[s];A(l)}o=!1},d(a){a&&k(e),r.block.d(a),r.token=null,r=null}}}function ut(n){var s;let e,t,o;function r(l){n[21](l)}let a={transactions:((s=n[0].transactionsByEnvelopeId)==null?void 0:s[n[12]])||[]};return n[6]!==void 0&&(a.selectedTransactionsById=n[6]),e=new Ue({props:a}),x.push(()=>oe(e,"selectedTransactionsById",r)),{c(){H(e.$$.fragment)},l(l){X(e.$$.fragment,l)},m(l,p){Y(e,l,p),o=!0},p(l,p){var u;const m={};p[0]&1&&(m.transactions=((u=l[0].transactionsByEnvelopeId)==null?void 0:u[l[12]])||[]),!t&&p[0]&64&&(t=!0,m.selectedTransactionsById=l[6],re(()=>t=!1)),e.$set(m)},i(l){o||(E(e.$$.fragment,l),o=!0)},o(l){A(e.$$.fragment,l),o=!1},d(l){F(e,l)}}}function ft(n){return{c:S,l:S,m:S,p:S,i:S,o:S,d:S}}function pt(n){let e,t,o;function r(s){n[22](s)}let a={transactions:n[31]};return n[6]!==void 0&&(a.selectedTransactionsById=n[6]),e=new Ue({props:a}),x.push(()=>oe(e,"selectedTransactionsById",r)),{c(){H(e.$$.fragment)},l(s){X(e.$$.fragment,s)},m(s,l){Y(e,s,l),o=!0},p(s,l){const p={};l[0]&32&&(p.transactions=s[31]),!t&&l[0]&64&&(t=!0,p.selectedTransactionsById=s[6],re(()=>t=!1)),e.$set(p)},i(s){o||(E(e.$$.fragment,s),o=!0)},o(s){A(e.$$.fragment,s),o=!1},d(s){F(e,s)}}}function dt(n){return{c:S,l:S,m:S,p:S,i:S,o:S,d:S}}function _t(n){var K;let e,t=n[3]||((K=Object.keys(n[6]))==null?void 0:K.length),o,r,a,s,l,p,m,u,f,d,g,i=t&&De(n),h=n[10]===ee&&Me(n);function $(c){n[25](c)}function C(c){n[26](c)}function z(c){n[27](c)}let V={};return n[8]!==void 0&&(V.isNegative=n[8]),n[7].value!==void 0&&(V.value=n[7].value),n[2]!==void 0&&(V.inputRef=n[2]),a=new it({props:V}),x.push(()=>oe(a,"isNegative",$)),x.push(()=>oe(a,"value",C)),x.push(()=>oe(a,"inputRef",z)),a.$on("enterPressed",n[13]),{c(){e=N("div"),i&&i.c(),o=M(),h&&h.c(),r=M(),H(a.$$.fragment),m=M(),u=N("textarea"),this.h()},l(c){e=B(c,"DIV",{class:!0});var b=O(e);i&&i.l(b),o=R(b),h&&h.l(b),b.forEach(k),r=R(c),X(a.$$.fragment,c),m=R(c),u=B(c,"TEXTAREA",{class:!0,id:!0,rows:!0,placeholder:!0}),O(u).forEach(k),this.h()},h(){T(e,"class","inline-flex self-end gap-4"),T(u,"class","textarea bg-base-200 ease-linear leading-4 resize-none"),T(u,"id","comment-input"),T(u,"rows","3"),T(u,"placeholder","Description")},m(c,b){W(c,e,b),i&&i.m(e,null),w(e,o),h&&h.m(e,null),W(c,r,b),Y(a,c,b),W(c,m,b),W(c,u,b),se(u,n[7].comment),f=!0,d||(g=P(u,"input",n[28]),d=!0)},p(c,b){var U;b[0]&72&&(t=c[3]||((U=Object.keys(c[6]))==null?void 0:U.length)),t?i?(i.p(c,b),b[0]&72&&E(i,1)):(i=De(c),i.c(),E(i,1),i.m(e,o)):i&&(me(),A(i,1,1,()=>{i=null}),_e()),c[10]===ee?h?(h.p(c,b),b[0]&1024&&E(h,1)):(h=Me(c),h.c(),E(h,1),h.m(e,null)):h&&(me(),A(h,1,1,()=>{h=null}),_e());const v={};!s&&b[0]&256&&(s=!0,v.isNegative=c[8],re(()=>s=!1)),!l&&b[0]&128&&(l=!0,v.value=c[7].value,re(()=>l=!1)),!p&&b[0]&4&&(p=!0,v.inputRef=c[2],re(()=>p=!1)),a.$set(v),b[0]&128&&se(u,c[7].comment)},i(c){f||(E(i),E(h),E(a.$$.fragment,c),f=!0)},o(c){A(i),A(h),A(a.$$.fragment,c),f=!1},d(c){c&&k(e),i&&i.d(),h&&h.d(),c&&k(r),F(a,c),c&&k(m),c&&k(u),d=!1,g()}}}function mt(n){let e,t,o;return{c(){e=N("textarea"),this.h()},l(r){e=B(r,"TEXTAREA",{class:!0,id:!0,rows:!0,placeholder:!0}),O(e).forEach(k),this.h()},h(){T(e,"class","textarea resize-none self-stretch bg-base-200 leading-4 ease-linear"),T(e,"id","comment-input"),T(e,"rows","7"),T(e,"placeholder","Transactions")},m(r,a){W(r,e,a),se(e,n[9]),n[24](e),t||(o=P(e,"input",n[23]),t=!0)},p(r,a){a[0]&512&&se(e,r[9])},i:S,o:S,d(r){r&&k(e),n[24](null),t=!1,o()}}}function De(n){let e,t,o,r,a,s,l;return t=new Ke({props:{size:"20",strokeWidth:"3"}}),{c(){e=N("button"),H(t.$$.fragment),o=te(`
            Copy`),this.h()},l(p){e=B(p,"BUTTON",{class:!0});var m=O(e);X(t.$$.fragment,m),o=ne(m,`
            Copy`),m.forEach(k),this.h()},h(){T(e,"class","text-dark inline-flex gap-2 items-center font-bold rounded-full py-2 px-2")},m(p,m){W(p,e,m),Y(t,e,null),w(e,o),a=!0,s||(l=P(e,"click",n[17]),s=!0)},p:S,i(p){a||(E(t.$$.fragment,p),p&&Fe(()=>{r||(r=Ae(e,Se,{duration:300},!0)),r.run(1)}),a=!0)},o(p){A(t.$$.fragment,p),p&&(r||(r=Ae(e,Se,{duration:300},!1)),r.run(0)),a=!1},d(p){p&&k(e),F(t),p&&r&&r.end(),s=!1,l()}}}function Me(n){let e,t,o,r,a,s,l,p,m,u,f;return o=new Qe({props:{size:"20",strokeWidth:"3"}}),l=new Ge({props:{size:"20",strokeWidth:"3"}}),{c(){e=N("span"),t=N("button"),H(o.$$.fragment),r=te(`
              Delete`),a=M(),s=N("button"),H(l.$$.fragment),p=te(`
              Paste`),this.h()},l(d){e=B(d,"SPAN",{class:!0});var g=O(e);t=B(g,"BUTTON",{class:!0});var i=O(t);X(o.$$.fragment,i),r=ne(i,`
              Delete`),i.forEach(k),a=R(g),s=B(g,"BUTTON",{class:!0});var h=O(s);X(l.$$.fragment,h),p=ne(h,`
              Paste`),h.forEach(k),g.forEach(k),this.h()},h(){T(t,"class","swap-on text-dark inline-flex gap-2 items-center font-bold rounded-full py-2 px-2"),T(s,"class","swap-off text-dark inline-flex gap-2 items-center font-bold rounded-full py-2 px-2"),T(e,"class","swap swap-flip svelte-eb6yxb"),Z(e,"swapActive",Object.keys(n[6]).length)},m(d,g){W(d,e,g),w(e,t),Y(o,t,null),w(t,r),w(e,a),w(e,s),Y(l,s,null),w(s,p),m=!0,u||(f=[P(t,"click",n[14]),P(s,"click",n[18])],u=!0)},p(d,g){g[0]&64&&Z(e,"swapActive",Object.keys(d[6]).length)},i(d){m||(E(o.$$.fragment,d),E(l.$$.fragment,d),m=!0)},o(d){A(o.$$.fragment,d),A(l.$$.fragment,d),m=!1},d(d){d&&k(e),F(o),F(l),u=!1,ke(f)}}}function ht(n){let e,t,o,r,a,s,l,p,m,u,f,d,g,i,h,$,C,z,V,K,c,b,v,U,Q;o=new nt({props:{envelope:n[11]}});const ie=[ut,ct],j=[];function ce(y,I){return y[10]===ve?0:1}s=ce(n),l=j[s]=ie[s](n);const ue=[mt,_t],L=[];function fe(y,I){return y[4]?0:1}return u=fe(n),f=L[u]=ue[u](n),{c(){e=N("div"),t=N("span"),H(o.$$.fragment),r=M(),a=N("span"),l.c(),p=M(),m=N("div"),f.c(),d=M(),g=N("div"),i=N("button"),h=te("Back"),$=M(),C=N("button"),z=N("span"),V=te("Spend"),K=M(),c=N("span"),b=te("Save"),this.h()},l(y){e=B(y,"DIV",{class:!0});var I=O(e);t=B(I,"SPAN",{class:!0});var _=O(t);X(o.$$.fragment,_),_.forEach(k),r=R(I),a=B(I,"SPAN",{class:!0});var G=O(a);l.l(G),G.forEach(k),p=R(I),m=B(I,"DIV",{class:!0});var D=O(m);f.l(D),d=R(D),g=B(D,"DIV",{class:!0});var q=O(g);i=B(q,"BUTTON",{class:!0});var ae=O(i);h=ne(ae,"Back"),ae.forEach(k),$=R(q),C=B(q,"BUTTON",{class:!0});var J=O(C);z=B(J,"SPAN",{class:!0});var le=O(z);V=ne(le,"Spend"),le.forEach(k),K=R(J),c=B(J,"SPAN",{class:!0});var ye=O(c);b=ne(ye,"Save"),ye.forEach(k),J.forEach(k),q.forEach(k),D.forEach(k),I.forEach(k),this.h()},h(){T(t,"class","sticky top-4 z-10 col-start-2 col-end-12 my-4"),T(a,"class","col-start-2 col-end-12 mb-4"),T(i,"class","w-22 btn btn-outline"),T(z,"class","swap-on"),T(c,"class","swap-off"),T(C,"class","w-22 btn swap btn-primary svelte-eb6yxb"),Z(C,"swapActive",n[8]&&!n[4]),T(g,"class","flex justify-around"),T(m,"class","sticky bottom-0 col-span-full mt-8 box-border flex flex-col space-y-4 rounded-t-3xl bg-base-100 p-6"),T(e,"class","layout-template-rows grid-layout min-h-full svelte-eb6yxb")},m(y,I){W(y,e,I),w(e,t),Y(o,t,null),w(e,r),w(e,a),j[s].m(a,null),w(e,p),w(e,m),L[u].m(m,null),w(m,d),w(m,g),w(g,i),w(i,h),w(g,$),w(g,C),w(C,z),w(z,V),w(C,K),w(C,c),w(c,b),v=!0,U||(Q=[P(i,"click",n[16]),P(C,"click",n[15])],U=!0)},p(y,I){const _={};I[0]&2048&&(_.envelope=y[11]),o.$set(_);let G=s;s=ce(y),s===G?j[s].p(y,I):(me(),A(j[G],1,1,()=>{j[G]=null}),_e(),l=j[s],l?l.p(y,I):(l=j[s]=ie[s](y),l.c()),E(l,1),l.m(a,null));let D=u;u=fe(y),u===D?L[u].p(y,I):(me(),A(L[D],1,1,()=>{L[D]=null}),_e(),f=L[u],f?f.p(y,I):(f=L[u]=ue[u](y),f.c()),E(f,1),f.m(m,d)),I[0]&272&&Z(C,"swapActive",y[8]&&!y[4])},i(y){v||(E(o.$$.fragment,y),E(l),E(f),v=!0)},o(y){A(o.$$.fragment,y),A(l),A(f),v=!1},d(y){y&&k(e),F(o),j[s].d(),L[u].d(),U=!1,ke(Q)}}}const ee="LOCAL",ve="NOTION";function bt(n,e,t){let o,r,a,s,l,p,m;de(n,xe,_=>t(29,s=_)),de(n,et,_=>t(20,l=_)),de(n,lt,_=>t(0,p=_)),de(n,tt,_=>t(30,m=_));const{id:u}=m.params;let f=null,d=null,g=null,i=!1;p.envelopes.length?Pe({envelopeId:u}):st().then(()=>Pe({envelopeId:u}));const h=()=>{document==null||document.getElementById("comment-input").focus()},$=async()=>{await s.deleteTransactions(Object.keys(b),u),t(6,b={}),t(5,c=await c.refresh())},C=()=>{switch(a){case ee:if(i){const _=Ie.parse(Q);t(9,Q=""),t(4,i=!1),_==null||_.forEach(J=>{var le=J,{envelope:G,value:D,date:q}=le,ae=ge(le,["envelope","value","date"]);s.saveTransaction(be(he({},ae),{value:D*100,date:Ne.fromFormat(q,Ce).toSeconds()}),u).then(async()=>{t(6,b={}),t(5,c=await c.refresh())})});return}$e()&&v.value&&s.saveTransaction(v,u).then(async _=>{t(7,v.value=0,v),t(7,v.comment="",v),t(5,c=await c.refresh()),d==null||d.focus(),t(3,g=_),t(6,b={})});break;case ve:v.value&&(at({envelopeId:r._id,transaction:v}),t(7,v.value=0,v),t(7,v.comment="",v));break}},z=()=>{if(i){t(4,i=!1);return}window.history.back()},V=()=>{switch(a){case ee:const _=g?[g]:Object.values(b);navigator.clipboard.writeText(Ie.stringify(_.map(ae=>{var J=ae,{envelopeId:G,_id:D}=J,q=ge(J,["envelopeId","_id"]);return be(he({envelope:r==null?void 0:r.name},q),{value:q.value/100,date:Ne.fromSeconds(q.date).toFormat(Ce)})}))).then(()=>{t(3,g=null),t(6,b={})}).catch(console.error);break}},K=async()=>{switch(a){case ee:t(4,i=!0),f==null||f.focus();break}};let c=s?s.getTransactionsPaginated({actions:s,envelopeId:u}):{},b={},v={value:0,comment:""},U=!0,Q="";function ie(_){b=_,t(6,b)}function j(_){b=_,t(6,b)}function ce(){Q=this.value,t(9,Q)}function ue(_){x[_?"unshift":"push"](()=>{f=_,t(1,f)})}function L(_){U=_,t(8,U)}function fe(_){n.$$.not_equal(v.value,_)&&(v.value=_,t(7,v))}function y(_){d=_,t(2,d)}function I(){v.comment=this.value,t(7,v)}return n.$$.update=()=>{n.$$.dirty[0]&1&&t(19,o=p.envelopes.find(({_id:_})=>_===u)),n.$$.dirty[0]&1572864&&t(11,r=l.find(({_id:_})=>_===u)||o||{}),n.$$.dirty[0]&524288&&t(10,a=o?ve:ee)},[p,f,d,g,i,c,b,v,U,Q,a,r,u,h,$,C,z,V,K,o,l,ie,j,ce,ue,L,fe,y,I]}class Nt extends Re{constructor(e){super();ze(this,e,bt,ht,Ve,{},null,[-1,-1])}}export{Nt as default};
