import{S as e,i as t,s as n,e as o,t as s,k as l,c as r,a,g as i,d as c,n as d,b as u,f,F as p,K as m,J as h,L as v,j as g,m as $,o as y,x,u as E,v as N,M as w,A as I,N as b,r as L,O as k,w as D,P as T,Q as P,R as C}from"../chunks/vendor-c8af0afa.js";import{f as V,P as j,T as A,g as M,R as _,m as R,a as S,e as X}from"../chunks/constants-7d44bea5.js";import{l as Y}from"../chunks/longpress-838b2f06.js";import"../chunks/singletons-12a22614.js";function O(e){let t,n,v,g,$,y,x,E,N,w,I,b,L=V(e[3])+"";return{c(){t=o("div"),n=o("div"),v=s(e[1]),g=l(),$=o("div"),y=o("div"),x=s(e[2]),E=l(),N=o("div"),w=s(L),this.h()},l(o){t=r(o,"DIV",{id:!0,class:!0});var s=a(t);n=r(s,"DIV",{class:!0});var l=a(n);v=i(l,e[1]),l.forEach(c),g=d(s),$=r(s,"DIV",{class:!0});var u=a($);y=r(u,"DIV",{class:!0});var f=a(y);x=i(f,e[2]),f.forEach(c),E=d(u),N=r(u,"DIV",{class:!0});var p=a(N);w=i(p,L),p.forEach(c),u.forEach(c),s.forEach(c),this.h()},h(){u(n,"class","text-5xl"),u(y,"class","text-2xl truncate"),u(N,"class","font-mono text-base"),u($,"class","text-dark flex flex-col overflow-hidden"),u(t,"id",e[0]),u(t,"class","bg-primary border-box flex space-x-2 rounded-3xl bg-primary shadow p-2")},m(o,s){f(o,t,s),p(t,n),p(n,v),p(t,g),p(t,$),p($,y),p(y,x),p($,E),p($,N),p(N,w),I||(b=m(t,"click",e[5]),I=!0)},p:h,i:h,o:h,d(e){e&&c(t),I=!1,b()}}}function z(e,t,n){let{envelope:o}=t,{_id:s,emoji:l,name:r,value:a}=o;return e.$$set=e=>{"envelope"in e&&n(4,o=e.envelope)},[s,l,r,a,o,function(t){v.call(this,e,t)}]}class B extends e{constructor(e){super(),t(this,e,z,O,n,{envelope:4})}}const F=["touchmove","mousemove"],W=["touchend","mouseup"],G=e=>{var t,n,o,s,l,r,a,i,c,d;const u={x:null!=(l=null!=(o=e.clientX)?o:null==(n=null==(t=e.changedTouches)?void 0:t[0])?void 0:n.clientX)?l:null==(s=e.detail)?void 0:s.clientX,y:null!=(d=null!=(i=e.clientY)?i:null==(a=null==(r=e.changedTouches)?void 0:r[0])?void 0:a.clientY)?d:null==(c=e.detail)?void 0:c.clientY};return null!=u.x&&null!=u.y||console.error("Unable to extract position from the event:",e),u},H=(e,{startEvent:t="mousedown",preventClickWhenReleasing:n=!1,onStart:o,onMove:s,onEnd:l}={})=>{let r=Array.from((null==e?void 0:e.children)||[]),a=null,i=null,c=-1,d=null,u={x:0,y:0};const f=e=>t=>{t.stopPropagation(),t.currentTarget.removeEventListener(t.type,f,e)},p=t=>{a=t.currentTarget,n&&t.currentTarget.addEventListener("click",f(!0),!0);const s=a.getBoundingClientRect(),l=G(t);r=Array.from((null==e?void 0:e.children)||[]),a.isDragging=!0,u.x=s.left-t.detail.clientX,u.y=s.top-t.detail.clientY,c=r.findIndex((e=>e===a)),i=a.cloneNode(!0),i.style["pointer-events"]="none",i.style["touch-action"]="none",i.style["z-index"]=1,i.style.width=`${a.clientWidth}px`,i.style.height=`${a.clientHeight}px`,i.style.position="fixed",i.style.top=0,i.style.left=0,i.style.transform=`translate(${s.left}px, ${s.top}px)`,e.appendChild(i),null==o||o({event:t,position:l,containerNode:e,itemNodeCopy:i,itemNode:a,itemNodes:r})},m=t=>{if(!i)return;const n=G(t),o=n.x+u.x,l=n.y+u.y;r=Array.from((null==e?void 0:e.children)||[]).filter((e=>e!==i)),c=r.findIndex((e=>e===a)),i.style.transform=`translate(${o}px, ${l}px)`;const f=document.elementsFromPoint(n.x,n.y).find((t=>(null==t?void 0:t.parentNode)===e&&t!==i));if(f===d)return;const p=r.findIndex((e=>e===f));d=f,p>=0&&c>=0&&c!==p&&(null==s||s({event:t,position:n,fromIndex:c,toIndex:p,toNode:f,containerNode:e,itemNodeCopy:i,itemNode:a,itemNodes:r}),c=p)},h=t=>{if(!i)return;t.stopPropagation(),t.stopImmediatePropagation();const n=G(t);a.style["pointer-events"]="auto",a.style["touch-action"]="auto",a.isDragging=void 0,i.remove(),i=null,null==l||l({event:t,itemNode:a,position:n,containerNode:e,itemNodeCopy:i,itemNodes:r})},v=e=>{e.addEventListener(t,p),F.forEach((e=>window.addEventListener(e,m))),W.forEach((e=>window.addEventListener(e,h)))},g=e=>{e.removeEventListener(t,p),F.forEach((t=>e.removeEventListener(t,m))),W.forEach((t=>e.removeEventListener(t,h)))};r.forEach(v);return new MutationObserver((e=>{Array.from(e).forEach((e=>{var t;return null==(t=e.addedNodes)?void 0:t.forEach((e=>{r.find((t=>t===e))||(v(e,r.length),r.push(e))}))}))})).observe(e,{childList:!0}),{update:()=>{console.error("Parementer updating is not implemented. The dragging behavior will not change.")},destroy:()=>{r.forEach(g)}}};function J(e,t,n){const o=e.slice();return o[10]=t[n],o}function K(e){let t,n,l,d,p,v,w,I;return p=new T({props:{size:"20"}}),{c(){t=o("img"),l=s("\n    Lopy\n    "),d=o("div"),g(p.$$.fragment),this.h()},l(e){t=r(e,"IMG",{class:!0,src:!0,alt:!0}),l=i(e,"\n    Lopy\n    "),d=r(e,"DIV",{class:!0});var n=a(d);$(p.$$.fragment,n),n.forEach(c),this.h()},h(){u(t,"class","mr-1 h-5 w-5"),P(t.src,n="/_app/assets/logo-transparent-a3926526.svg")||u(t,"src","/_app/assets/logo-transparent-a3926526.svg"),u(t,"alt","Lopy"),u(d,"class","cursor-pointer ml-auto")},m(n,o){f(n,t,o),f(n,l,o),f(n,d,o),y(p,d,null),v=!0,w||(I=m(d,"click",e[6]),w=!0)},p:h,i(e){v||(x(p.$$.fragment,e),v=!0)},o(e){E(p.$$.fragment,e),v=!1},d(e){e&&c(t),e&&c(l),e&&c(d),N(p),w=!1,I()}}}function Q(e,t){let n,s,i,m,h,v;return s=new B({props:{envelope:t[10]}}),s.$on("click",(function(){return t[7](t[10])})),{key:e,first:null,c(){n=o("span"),g(s.$$.fragment),i=l(),this.h()},l(e){n=r(e,"SPAN",{class:!0});var t=a(n);$(s.$$.fragment,t),i=d(t),t.forEach(c),this.h()},h(){u(n,"class","outline-none cursor-unset"),this.first=n},m(e,t){f(e,n,t),y(s,n,null),p(n,i),m=!0,h||(v=b(Y.call(null,n)),h=!0)},p(e,n){t=e;const o={};2&n&&(o.envelope=t[10]),s.$set(o)},i(e){m||(x(s.$$.fragment,e),m=!0)},o(e){E(s.$$.fragment,e),m=!1},d(e){e&&c(n),N(s),h=!1,v()}}}function U(e){let t,n,s,i,p,m,h=[],v=new Map;t=new A({props:{$$slots:{default:[K]},$$scope:{ctx:e}}});let w=e[1];const I=e=>e[10]._id;for(let o=0;o<w.length;o+=1){let t=J(e,w,o),n=I(t);v.set(n,h[o]=Q(n,t))}return{c(){g(t.$$.fragment),n=l(),s=o("div");for(let e=0;e<h.length;e+=1)h[e].c();this.h()},l(e){$(t.$$.fragment,e),n=d(e),s=r(e,"DIV",{class:!0});var o=a(s);for(let t=0;t<h.length;t+=1)h[t].l(o);o.forEach(c),this.h()},h(){u(s,"class","w-full p-4 flex flex-col space-y-3")},m(o,l){y(t,o,l),f(o,n,l),f(o,s,l);for(let e=0;e<h.length;e+=1)h[e].m(s,null);i=!0,p||(m=b(H.call(null,s,{startEvent:"longpress",onStart:e[3],onMove:e[4],onEnd:e[5]})),p=!0)},p(e,n){const o={};8192&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o),7&n&&(w=e[1],L(),h=k(h,n,I,1,e,w,v,s,C,Q,null,J),D())},i(e){if(!i){x(t.$$.fragment,e);for(let e=0;e<w.length;e+=1)x(h[e]);i=!0}},o(e){E(t.$$.fragment,e);for(let t=0;t<h.length;t+=1)E(h[t]);i=!1},d(e){N(t,e),e&&c(n),e&&c(s);for(let t=0;t<h.length;t+=1)h[t].d();p=!1,m()}}}function q(e){let t,n;return t=new j({props:{$$slots:{default:[U]},$$scope:{ctx:e}}}),{c(){g(t.$$.fragment)},l(e){$(t.$$.fragment,e)},m(e,o){y(t,e,o),n=!0},p(e,[n]){const o={};8195&n&&(o.$$scope={dirty:n,ctx:e}),t.$set(o)},i(e){n||(x(t.$$.fragment,e),n=!0)},o(e){E(t.$$.fragment,e),n=!1},d(e){N(t,e)}}}function Z(e,t,n){let o,s;w(e,S,(e=>n(9,o=e))),w(e,X,(e=>n(1,s=e)));let l=!1;const r=e=>{M(`${_.ENVELOPE}/${e._id}`)};let a;I((()=>{a=document.getElementsByTagName("main")[0]}));return[l,s,r,({itemNodeCopy:e,itemNode:t})=>{e.style["box-shadow"]="0px 4px 6px -2px rgba(0,0,0,0.8)",e.style.transform=`${e.style.transform} scale(1.01, 1.01)`,t.style.opacity="10%",a.style["overflow-y"]="hidden"},({itemNodeCopy:e,fromIndex:t,toIndex:r})=>{n(0,l=!0);const a=R(s,t,r);e.style.transform=`${e.style.transform} scale(1.01, 1.01)`,o.reorderEnvelopes(a)},async({itemNode:e})=>{setTimeout((()=>{n(0,l=!1)}),0),e.style.opacity="100%",a.style["overflow-y"]="scroll"},()=>M(`${_.EDIT}/new`),e=>!l&&r(e)]}class ee extends e{constructor(e){super(),t(this,e,Z,q,n,{})}}export{ee as default};
