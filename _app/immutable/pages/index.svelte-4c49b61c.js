import{S as ce,i as ie,s as ue,N,O as ee,n as k,h as $,p as w,q as H,b as F,H as E,E as W,l as P,w as V,a as A,r as fe,m as T,x as X,c as B,u as pe,y as Y,R as te,a3 as me,a1 as de,d as he,f as z,t as C,B as M,T as ge,L as U,$ as ve,o as _e,g as ye,ae as xe}from"../chunks/index-2c5b7e63.js";import{P as Ee,E as $e}from"../chunks/Envelope-39db26e1.js";import{B as we}from"../chunks/BottomNavigation-39bffc7d.js";import{f as be,n as ke}from"../chunks/notionStore-a2e2d424.js";import{g as se,R as ne,m as Ie,a as Pe,e as Te}from"../chunks/stores-a17a1f11.js";import{l as Le}from"../chunks/longpress-f0a75fa9.js";import"../chunks/index-a5fb40b1.js";import"../chunks/singletons-eca981c1.js";function Oe(e){let s,t;return{c(){s=N("svg"),t=N("path"),this.h()},l(r){s=ee(r,"svg",{"xmlns:svg":!0,xmlns:!0,viewBox:!0});var p=k(s);t=ee(p,"path",{transform:!0,style:!0,d:!0}),k(t).forEach($),p.forEach($),this.h()},h(){w(t,"transform","translate(-84.928348,-118.03593)"),H(t,"fill","currentColor"),H(t,"fill-opacity","1"),H(t,"stroke-width","0.06742518"),w(t,"d","m 101.44525,119.10059 c -0.24265,-0.0583 -0.49278,-0.0771 -0.74024,-0.0567 l -0.972924,4.92984 c 0.01356,-0.006 0.0269,-0.0127 0.04046,-0.0183 0.573884,-0.22252 1.147444,-0.32802 1.721324,-0.31631 0.58559,0.0234 1.15966,0.16395 1.72183,0.4216 0.0792,0.0372 0.15725,0.0769 0.23465,0.11803 0.63679,-0.54903 1.23152,-1.14018 1.78724,-1.77029 l -2.68727,-2.68701 c -0.31688,-0.31689 -0.70067,-0.52372 -1.10508,-0.6209 z m 5.102,4.61781 c -0.60086,0.51094 -1.15816,1.03627 -1.63135,1.58977 0.41277,0.43139 0.74839,0.88241 1.005,1.35286 0.28108,0.51532 0.47428,0.98953 0.57968,1.42286 l -1.739,0.75537 c -0.082,-0.40992 -0.22869,-0.80221 -0.4395,-1.17698 -0.18738,-0.3748 -0.43897,-0.72024 -0.75518,-1.03646 -0.57389,-0.57388 -1.19459,-0.87849 -1.86215,-0.91363 -0.64415,-0.0351 -1.26487,0.24574 -1.862178,0.84305 -0.327932,0.32793 -0.562318,0.66795 -0.702908,1.01927 -0.128815,0.36306 -0.20477,0.73165 -0.228148,1.10644 -0.01172,0.38649 0.01753,0.7789 0.08779,1.17709 0.08197,0.40991 0.16971,0.83735 0.263412,1.28241 0.0937,0.44503 0.175849,0.91354 0.24612,1.40543 0.07027,0.49191 0.07614,0.98984 0.01758,1.49344 -0.03512,0.50361 -0.169966,1.01295 -0.404086,1.52829 -0.210824,0.51533 -0.568096,1.02472 -1.071704,1.52832 -0.456762,0.45675 -0.960228,0.8199 -1.510677,1.08927 -0.550475,0.26936 -1.136098,0.40987 -1.756818,0.4216 -0.59731,0.0117 -1.218077,-0.11734 -1.862221,-0.38671 -0.177586,-0.077 -0.354613,-0.16964 -0.531231,-0.27449 -0.612231,0.55052 -1.236191,1.08931 -1.787843,1.70042 l 2.703134,2.70303 c 0.915628,0.91563 2.390021,0.91547 3.305654,-1.4e-4 l 12.630984,-12.63094 c 0.91563,-0.91564 0.91566,-2.38969 4e-5,-3.30532 z m -9.452901,7.89156 -6.158029,1.21571 -5.23e-4,0.002 c 0.117112,0.4919 0.275481,0.95436 0.474598,1.3877 0.222559,0.4333 0.544268,0.86085 0.965891,1.28247 0.632438,0.63244 1.294392,0.94297 1.985378,0.93125 0.702715,0 1.352507,-0.29898 1.949807,-0.89628 0.316219,-0.31622 0.544566,-0.64976 0.685151,-1.00107 0.140569,-0.35132 0.222559,-0.71453 0.245995,-1.08935 0.03512,-0.36304 0.02355,-0.73781 -0.03501,-1.1243 -0.03538,-0.23351 -0.07341,-0.46984 -0.113072,-0.70761 z m -7.977954,1.57504 -3.180084,0.62767 c -0.05449,0.6599 0.170595,1.33828 0.677615,1.84529 l 2.671718,2.67192 c 0.571755,-0.4906 1.158462,-0.95635 1.663483,-1.55818 -0.499165,-0.51766 -0.885284,-1.03023 -1.155321,-1.53791 -0.292804,-0.55047 -0.497925,-1.0949 -0.615047,-1.63364 -0.0325,-0.138 -0.05294,-0.27745 -0.06236,-0.41515 z"),w(s,"xmlns:svg","http://www.w3.org/2000/svg"),w(s,"xmlns","http://www.w3.org/2000/svg"),w(s,"viewBox","0 0 26 25.999761")},m(r,p){F(r,s,p),E(s,t)},p:W,i:W,o:W,d(r){r&&$(s)}}}class De extends ce{constructor(s){super(),ie(this,s,null,Oe,ue,{})}}const le=["touchmove","mousemove"],re=["touchend","mouseup"],j=e=>{var t,r,p,g,a,c,n,m,d,y;const s={x:(a=(p=e.clientX)!=null?p:(r=(t=e.changedTouches)==null?void 0:t[0])==null?void 0:r.clientX)!=null?a:(g=e.detail)==null?void 0:g.clientX,y:(y=(m=e.clientY)!=null?m:(n=(c=e.changedTouches)==null?void 0:c[0])==null?void 0:n.clientY)!=null?y:(d=e.detail)==null?void 0:d.clientY};return s.x!=null&&s.y!=null||console.error("Unable to extract position from the event:",e),s},Se=(e,{startEvent:s="mousedown",preventClickWhenReleasing:t=!1,onStart:r,onMove:p,onEnd:g}={})=>{let a=Array.from((e==null?void 0:e.children)||[]),c=null,n=null,m=-1,d=null,y={x:0,y:0};const L=i=>f=>{f.stopPropagation(),f.currentTarget.removeEventListener(f.type,L,i)},x=i=>{c=i.currentTarget,t&&i.currentTarget.addEventListener("click",L(!0),!0);const f=c.getBoundingClientRect(),b=j(i);a=Array.from((e==null?void 0:e.children)||[]),c.isDragging=!0,y.x=f.left-i.detail.clientX,y.y=f.top-i.detail.clientY,m=a.findIndex(O=>O===c),n=c.cloneNode(!0),n.style["pointer-events"]="none",n.style["touch-action"]="none",n.style["z-index"]=1,n.style.width=`${c.clientWidth}px`,n.style.height=`${c.clientHeight}px`,n.style.position="fixed",n.style.top=0,n.style.left=0,n.style.transform=`translate(${f.left}px, ${f.top}px)`,e.appendChild(n),r==null||r({event:i,position:b,containerNode:e,itemNodeCopy:n,itemNode:c,itemNodes:a})},v=i=>{if(!n)return;const f=j(i),b={x:f.x+y.x,y:f.y+y.y};a=Array.from((e==null?void 0:e.children)||[]).filter(h=>h!==n),m=a.findIndex(h=>h===c),n.style.transform=`translate(${b.x}px, ${b.y}px)`;const l=document.elementsFromPoint(f.x,f.y).find(h=>(h==null?void 0:h.parentNode)===e&&h!==n);if(l===d)return;const o=a.findIndex(h=>h===l);d=l,o>=0&&m>=0&&m!==o&&(p==null||p({event:i,position:f,fromIndex:m,toIndex:o,toNode:l,containerNode:e,itemNodeCopy:n,itemNode:c,itemNodes:a}),m=o)},S=i=>{if(!n)return;i.stopPropagation(),i.stopImmediatePropagation();const f=j(i);c.style["pointer-events"]="auto",c.style["touch-action"]="auto",c.isDragging=void 0,n.remove(),n=null,g==null||g({event:i,itemNode:c,position:f,containerNode:e,itemNodeCopy:n,itemNodes:a})},D=i=>{i.addEventListener(s,x),le.forEach(f=>window.addEventListener(f,v)),re.forEach(f=>window.addEventListener(f,S))},u=i=>{i.removeEventListener(s,x),le.forEach(f=>i.removeEventListener(f,v)),re.forEach(f=>i.removeEventListener(f,S))};a.forEach(D);const _=i=>{Array.from(i).forEach(b=>{var O;return(O=b.addedNodes)==null?void 0:O.forEach(l=>{a.find(o=>o===l)||(D(l,a.length),a.push(l))})})};return new MutationObserver(_).observe(e,{childList:!0}),{update:()=>{console.error("Parementer updating is not implemented. The dragging behavior will not change.")},destroy:()=>{a.forEach(u)}}};function oe(e,s,t){const r=e.slice();return r[14]=s[t],r}function ae(e,s){let t,r,p,g,a,c;function n(){return s[11](s[14])}return r=new $e({props:{envelope:s[14]}}),r.$on("click",n),{key:e,first:null,c(){t=P("span"),V(r.$$.fragment),p=A(),this.h()},l(m){t=T(m,"SPAN",{class:!0});var d=k(t);X(r.$$.fragment,d),p=B(d),d.forEach($),this.h()},h(){w(t,"class","cursor-unset outline-none"),this.first=t},m(m,d){F(m,t,d),Y(r,t,null),E(t,p),g=!0,a||(c=me(Le.call(null,t)),a=!0)},p(m,d){s=m;const y={};d&10&&(y.envelope=s[14]),r.$set(y)},i(m){g||(z(r.$$.fragment,m),g=!0)},o(m){C(r.$$.fragment,m),g=!1},d(m){m&&$(t),M(r),a=!1,c()}}}function Ae(e){let s,t,r,p,g,a,c,n,m,d,y,L,x,v=[],S=new Map,D,u,_,I,i,f;p=new De({}),n=new Ee({props:{strokeWidth:"2.6",size:"28"}});let b=[...e[3].envelopes,...e[1]];const O=l=>l[14]._id;for(let l=0;l<b.length;l+=1){let o=oe(e,b,l),h=O(o);S.set(h,v[l]=ae(h,o))}return _=new we({}),{c(){s=P("div"),t=P("div"),r=P("span"),V(p.$$.fragment),g=A(),a=P("span"),c=P("button"),V(n.$$.fragment),m=A(),d=P("span"),y=fe("lopy"),L=A(),x=P("div");for(let l=0;l<v.length;l+=1)v[l].c();D=A(),u=P("div"),V(_.$$.fragment),this.h()},l(l){s=T(l,"DIV",{class:!0});var o=k(s);t=T(o,"DIV",{class:!0});var h=k(t);r=T(h,"SPAN",{class:!0});var G=k(r);X(p.$$.fragment,G),G.forEach($),g=B(h),a=T(h,"SPAN",{class:!0});var R=k(a);c=T(R,"BUTTON",{class:!0});var J=k(c);X(n.$$.fragment,J),J.forEach($),m=B(R),d=T(R,"SPAN",{class:!0});var K=k(d);y=pe(K,"lopy"),K.forEach($),R.forEach($),h.forEach($),L=B(o),x=T(o,"DIV",{class:!0});var Q=k(x);for(let q=0;q<v.length;q+=1)v[q].l(Q);Q.forEach($),D=B(o),u=T(o,"DIV",{class:!0});var Z=k(u);X(_.$$.fragment,Z),Z.forEach($),o.forEach($),this.h()},h(){w(r,"class","w-14 cursor-pointer fill-current"),w(c,"class","btn glass btn-circle btn-sm"),w(d,"class","text-4xl font-normal"),w(a,"class","flex items-center space-x-2 whitespace-nowrap"),w(t,"class","font-base col-start-2 col-end-12 flex flex-nowrap items-center justify-around self-start py-14 text-neutral-content md:col-start-6"),w(x,"class","col-span-full col-start-2 col-end-12 flex w-full flex-col space-y-3 md:col-start-6"),w(u,"class","sticky bottom-0 col-span-full mt-8 md:col-span-3 md:col-start-2 md:row-start-1"),w(s,"class","layout-template-rows grid-layout min-h-full bg-transparent svelte-9e2t90")},m(l,o){F(l,s,o),E(s,t),E(t,r),Y(p,r,null),E(t,g),E(t,a),E(a,c),Y(n,c,null),E(a,m),E(a,d),E(d,y),E(s,L),E(s,x);for(let h=0;h<v.length;h+=1)v[h].m(x,null);E(s,D),E(s,u),Y(_,u,null),I=!0,i||(f=[te(r,"click",e[9]),te(c,"click",e[10]),me(Se.call(null,x,{startEvent:"longpress",onStart:e[6],onMove:e[7],onEnd:e[8]}))],i=!0)},p(l,[o]){o&43&&(b=[...l[3].envelopes,...l[1]],ye(),v=de(v,o,O,1,l,b,S,x,xe,ae,null,oe),he())},i(l){if(!I){z(p.$$.fragment,l),z(n.$$.fragment,l);for(let o=0;o<b.length;o+=1)z(v[o]);z(_.$$.fragment,l),I=!0}},o(l){C(p.$$.fragment,l),C(n.$$.fragment,l);for(let o=0;o<v.length;o+=1)C(v[o]);C(_.$$.fragment,l),I=!1},d(l){l&&$(s),M(p),M(n);for(let o=0;o<v.length;o+=1)v[o].d();M(_),i=!1,ge(f)}}}function Be(e,s,t){let r,p,g,a;U(e,Pe,u=>t(13,r=u)),U(e,Te,u=>t(1,p=u)),U(e,ke,u=>t(3,a=u)),be();const c=ve("themeStore");U(e,c,u=>t(2,g=u));let n=!1;const m=u=>{se(`${ne.ENVELOPE}/${u._id}`)},d=({itemNodeCopy:u,itemNode:_})=>{u.style["box-shadow"]="0px 4px 6px -2px rgba(0,0,0,0.8)",u.style.transform=`${u.style.transform} scale(1.01, 1.01)`,_.style.opacity="10%",x.style["overflow-y"]="hidden"},y=({itemNodeCopy:u,fromIndex:_,toIndex:I})=>{t(0,n=!0);const i=Ie(p,_,I);u.style.transform=`${u.style.transform} scale(1.01, 1.01)`,r.reorderEnvelopes(i)},L=async({itemNode:u})=>{setTimeout(()=>{t(0,n=!1)},0),u.style.opacity="100%",x.style["overflow-y"]="scroll"};let x;return _e(()=>{x=document.getElementsByTagName("main")[0]}),[n,p,g,a,c,m,d,y,L,()=>{const{currentTheme:u,themes:_}=g,I=_.findIndex(i=>u===i);c.set({themes:_,currentTheme:_[I+1]||_[0]})},()=>se(`${ne.EDIT}/new`),u=>!n&&m(u)]}class qe extends ce{constructor(s){super(),ie(this,s,Be,Ae,ue,{})}}export{qe as default};
