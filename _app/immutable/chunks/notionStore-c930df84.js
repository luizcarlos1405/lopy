import{w as r}from"./index-a5fb40b1.js";const o={token:localStorage.getItem("token"),pageId:localStorage.getItem("pageId"),transactionsDatabaseId:localStorage.getItem("transactionsDatabaseId"),envelopesDatabaseId:localStorage.getItem("envelopesDatabaseId"),apiEndpoint:"https://lopy-notion-api.deno.dev/api/"},c=r({envelopes:[]}),i=async()=>{const e=new Headers;e.append("procedure","listEnvelopes"),e.append("Authorization",`Bearer ${o.token}`),e.append("Content-Type","application/json");const n=JSON.stringify({envelopesDatabaseId:o.envelopesDatabaseId}),s={method:"POST",headers:e,body:n},p=await fetch(`${o.apiEndpoint}notion-procedures`,s).then(t=>t.json()).catch(t=>(console.error(t),[]));c.update(t=>({...t,envelopes:p}))},d=async({envelopeId:e})=>{const n=new Headers;n.append("procedure","listEnvelopeTransactions"),n.append("Authorization",`Bearer ${o.token}`),n.append("Content-Type","application/json");const s=JSON.stringify({transactionsDatabaseId:o.transactionsDatabaseId,envelopePageId:e}),p={method:"POST",headers:n,body:s},t=await fetch(`${o.apiEndpoint}notion-procedures`,p).then(a=>a.json()).catch(a=>(console.error(a),[]));c.update(a=>({...a,transactionsByEnvelopeId:{...a.transactionsByEnvelopeId,[e]:t}}))},h=async({envelopeId:e,transaction:n})=>{const s=new Headers;s.append("procedure","addTransaction"),s.append("Authorization",`Bearer ${o.token}`),s.append("Content-Type","application/json");const p=JSON.stringify({transactionsDatabaseId:o.transactionsDatabaseId,envelopePageId:e,comment:n.comment||"",value:n.value/100}),t={method:"POST",headers:s,body:p};await fetch(`${o.apiEndpoint}notion-procedures`,t).then(a=>a.json()).catch(a=>(console.error(a),[])),await i(),await d({envelopeId:e})};export{d as a,o as c,i as f,c as n,h as s};
